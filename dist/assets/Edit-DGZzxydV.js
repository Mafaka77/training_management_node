import{y as U,s as B,L as D,m as P,o as p,c as b,b as l,a as t,j as g,k as v,u as f,G as H,w as A,T as E,D as N,h as c,H as R}from"./index-BV9NVDf5.js";import{u as $}from"./trainingStore-C1fAIYtw.js";import{M as G,I}from"./ImagePicker-BNt2yvMj.js";import{B as d}from"./BaseInput-Dax87Xvs.js";import{S as k}from"./SingleSelect-GTCaIoaM.js";import{_ as O}from"./Breadcrumbs-T6b1-PtM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"max-w-5xl mx-auto pb-12"},F={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},q={class:"flex items-center justify-between mb-6"},W={key:0},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},J={class:"md:col-span-2 space-y-4"},K={class:"md:col-span-1"},Q={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},X={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},Z={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"space-y-6"},ae={class:"space-y-6"},oe={class:"grid grid-cols-2 gap-4"},se={class:"flex items-center justify-end gap-4 pt-4"},le={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-zinc-900/60 backdrop-blur-sm"},re={class:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-3xl shadow-2xl border border-zinc-200 dark:border-white/10 overflow-hidden"},ie={class:"flex items-center gap-3 p-6 bg-zinc-50 dark:bg-white/[0.02] border-t border-zinc-100 dark:border-white/5"},ne=["disabled"],de={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},_e={__name:"Edit",setup(ce){const n=N(),r=U(),i=$(),{categories:w,rooms:V,groups:z}=B(i),x=c(!1),h=c(!1),y=c(!1),u=c(!1),m=c(!1),a=R({t_name:"",t_description:"",t_banner:null,t_start_date:"",t_end_date:"",t_duration:0,t_eligibility:[],t_organizer:"",t_capacity:0,t_category:"",t_room:"",t_status:""}),C=[{label:"Training",to:"/admin/training/program"},{label:"Edit Program",to:"/admin/training/program/edit/"+n.params.id}];function T(s){a.t_banner=s}const M=async()=>{if(!a.t_name||!a.t_start_date||!a.t_category){r.error("Please fill in the required fields.");return}x.value=!0;const s=new FormData;Object.keys(a).forEach(e=>{});try{let e;h.value?e=await i.updateTraining(n.params.id,s):e=await i.submitTraining(s),e.success?(r.success(h.value?"Updated successfully!":"Created successfully!"),router.push("/admin/training/program")):r.error(e.message||"Action failed")}catch{r.error("An unexpected error occurred.")}finally{x.value=!1}};D(()=>n.params.id,s=>{s&&_(s)});async function _(s){y.value=!0;try{const e=await i.fetchTraining(s);e.t_start_date&&(e.t_start_date=e.t_start_date.split("T")[0]),e.t_end_date&&(e.t_end_date=e.t_end_date.split("T")[0]);const o={...e,t_category:e.t_category?._id||e.t_category,t_room:e.t_room?._id||e.t_room,t_eligibility:e.t_eligibility||[]};Object.assign(a,o),console.log(a)}catch(e){r.error("Could not fetch training details"),console.error(e)}finally{y.value=!1}}const S=()=>{u.value=!0},j=async s=>{m.value=!0;try{const e=await i.updateStatus(s);e.success?(r.success(e.message),u.value=!1,await _(n.params.id)):r.warning(e.message)}catch(e){r.warning(e)}finally{m.value=!1}};return P(async()=>{await Promise.all([i.fetchCategories(),i.fetchRooms(),i.fetchGroups()]);const s=n.params.id;s&&(h.value=!0,await _(s))}),(s,e)=>(p(),b("div",L,[l(O,{items:C}),t("form",{onSubmit:H(M,["prevent"]),class:"space-y-6"},[t("section",F,[t("div",q,[e[13]||(e[13]=t("div",{class:"flex items-center gap-2 text-blue-600"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"General Information")],-1)),a.t_status==="Draft"?(p(),b("div",W,[t("button",{type:"button",onClick:S,class:"px-4 py-2 text-xs font-bold text-blue-600 bg-blue-50 hover:bg-blue-100 dark:bg-blue-500/10 dark:text-blue-400 dark:hover:bg-blue-500/20 border border-blue-200 dark:border-blue-500/30 rounded-xl transition-all active:scale-95 flex items-center gap-2"},[...e[12]||(e[12]=[t("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),g(" Mark as Upcoming ",-1)])])])):v("",!0)]),t("div",Y,[t("div",J,[l(d,{modelValue:a.t_name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.t_name=o),label:"Training Program Name",placeholder:"e.g. Advanced Cybersecurity Workshop",type:"text"},null,8,["modelValue"]),l(d,{modelValue:a.t_description,"onUpdate:modelValue":e[1]||(e[1]=o=>a.t_description=o),label:"Program Overview",placeholder:"Describe the objectives and outcomes...",type:"textarea",rows:"4"},null,8,["modelValue"])]),t("div",K,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"},"Program Banner",-1)),l(I,{type:"file",accept:".png, .jpg, .jpeg",class:"h-[188px]",onChange:T})])])]),t("section",Q,[e[15]||(e[15]=t("div",{class:"flex items-center gap-2 mb-6 text-amber-500"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"Timeline")],-1)),t("div",X,[l(d,{modelValue:a.t_start_date,"onUpdate:modelValue":e[2]||(e[2]=o=>a.t_start_date=o),label:"Start Date",type:"date"},null,8,["modelValue"]),l(d,{modelValue:a.t_end_date,"onUpdate:modelValue":e[3]||(e[3]=o=>a.t_end_date=o),label:"End Date",type:"date"},null,8,["modelValue"])])]),t("section",Z,[e[16]||(e[16]=t("div",{class:"flex items-center gap-2 mb-6 text-emerald-500"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"Training Logistics")],-1)),t("div",ee,[t("div",te,[l(d,{modelValue:a.t_organizer,"onUpdate:modelValue":e[4]||(e[4]=o=>a.t_organizer=o),label:"Organizer / Department",placeholder:"e.g. HR Department",type:"text"},null,8,["modelValue"]),l(G,{modelValue:a.t_eligibility,"onUpdate:modelValue":e[5]||(e[5]=o=>a.t_eligibility=o),options:f(z),"track-by":"_id","option-label":"group_name",label:"Target Eligibility Groups",placeholder:"Select allowed groups"},null,8,["modelValue","options"])]),t("div",ae,[t("div",oe,[l(d,{modelValue:a.t_capacity,"onUpdate:modelValue":e[6]||(e[6]=o=>a.t_capacity=o),label:"Seat Capacity",placeholder:"50",type:"number"},null,8,["modelValue"]),l(k,{modelValue:a.t_category,"onUpdate:modelValue":e[7]||(e[7]=o=>a.t_category=o),options:f(w),"track-by":"_id","option-label":"name",label:"Category",placeholder:"Select Type"},null,8,["modelValue","options"])]),l(k,{modelValue:a.t_room,"onUpdate:modelValue":e[8]||(e[8]=o=>a.t_room=o),options:f(V),"track-by":"_id","option-label":"room_name",label:"Assigned Room / Venue",placeholder:"Select Venue"},null,8,["modelValue","options"])])])]),t("div",se,[t("button",{type:"button",onClick:e[9]||(e[9]=o=>s.$router.back()),class:"px-6 py-2.5 rounded-xl text-zinc-500 hover:bg-zinc-100 dark:hover:bg-white/5 font-semibold transition-all"}," Cancel "),e[17]||(e[17]=t("button",{type:"submit",class:"px-8 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-bold shadow-lg shadow-blue-500/30 transition-all active:scale-95"}," Update Training Program ",-1))])],32),l(E,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:A(()=>[u.value?(p(),b("div",le,[t("div",re,[e[19]||(e[19]=t("div",{class:"p-6 text-center"},[t("div",{class:"mx-auto w-16 h-16 rounded-full bg-blue-50 dark:bg-blue-500/10 flex items-center justify-center text-blue-600 mb-4"},[t("svg",{class:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])]),t("h3",{class:"text-xl font-bold text-zinc-900 dark:text-zinc-100 mb-2"},"Change Status?"),t("p",{class:"text-sm text-zinc-500 dark:text-zinc-400 px-4"},[g(" Are you sure you want to mark this training as "),t("span",{class:"font-bold text-blue-600"},"Upcoming"),g("? This will be available to public. ")])],-1)),t("div",ie,[t("button",{onClick:e[10]||(e[10]=o=>u.value=!1),class:"flex-1 px-5 py-3 text-sm font-bold text-zinc-500 hover:bg-zinc-200 dark:hover:bg-white/5 rounded-2xl transition-all"}," Cancel "),t("button",{onClick:e[11]||(e[11]=o=>j(f(n).params.id)),disabled:m.value,class:"flex-1 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-2xl shadow-lg shadow-blue-500/20 transition-all disabled:opacity-50 flex items-center justify-center gap-2"},[m.value?(p(),b("span",de)):v("",!0),e[18]||(e[18]=g(" Yes, Confirm ",-1))],8,ne)])])])):v("",!0)]),_:1})]))}};export{_e as default};
