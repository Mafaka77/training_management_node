import{y as B,s as P,E as A,m as E,o as b,c as g,b as l,a as t,j as f,k as v,u,I as N,w as O,T as H,G as $,h as c,J as I}from"./index-DGnyFPjq.js";import{u as R}from"./trainingStore-CrMzvMRL.js";import{M as F}from"./MultiSelect-BfHRitL9.js";import{B as d}from"./BaseInput-C3_cv4Ja.js";import{_ as G}from"./SearchSelect-Bkx9FKM-.js";import{S as x}from"./SingleSelect-DHsD6JBp.js";import{I as J}from"./ImagePicker-fILJa8jY.js";import{_ as L}from"./Breadcrumbs-RZ7m6sW0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"max-w-5xl mx-auto pb-12"},W={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},Y={class:"flex items-center justify-between mb-6"},K={key:0},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},X={class:"md:col-span-2 space-y-4"},Z={class:"md:col-span-1"},ee={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},ae={class:"bg-white dark:bg-zinc-900/50 border border-zinc-200 dark:border-white/10 rounded-2xl p-6 shadow-sm"},oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},se={class:"space-y-6"},le={class:"space-y-6"},re={class:"grid grid-cols-2 gap-4"},ie={class:"flex items-center justify-end gap-4 pt-4"},ne={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-zinc-900/60 backdrop-blur-sm"},de={class:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-3xl shadow-2xl border border-zinc-200 dark:border-white/10 overflow-hidden"},ue={class:"flex items-center gap-3 p-6 bg-zinc-50 dark:bg-white/[0.02] border-t border-zinc-100 dark:border-white/5"},ce=["disabled"],me={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},ke={__name:"Edit",setup(pe){const n=$(),i=B(),r=R(),{categories:k,rooms:V,groups:z,directors:C}=P(r),y=c(!1),_=c(!1),w=c(!1),m=c(!1),p=c(!1),S=[{name:"Draft",value:"Draft"},{name:"Upcoming",value:"Upcoming"},{name:"Ongoing",value:"Ongoing"},{name:"Completed",value:"Completed"}],a=I({t_name:"",t_description:"",t_banner:null,t_start_date:"",t_end_date:"",t_duration:0,t_eligibility:[],t_organizer:"",t_capacity:0,t_category:"",t_room:"",t_status:"",t_director:""}),T=[{label:"Training",to:"/admin/training/program"},{label:"Edit Program",to:"/admin/training/program/edit/"+n.params.id}];function U(s){a.t_banner=s}const M=async()=>{if(!a.t_name||!a.t_start_date||!a.t_category){i.error("Please fill in the required fields.");return}y.value=!0;const s=new FormData;Object.keys(a).forEach(e=>{a[e]instanceof File?s.append(e,a[e]):Array.isArray(a[e])?s.append(e,JSON.stringify(a[e])):s.append(e,a[e])});try{let e;_.value?e=await r.updateTraining(n.params.id,s):e=await r.submitTraining(s),e.success?i.success(_.value?"Updated successfully!":"Created successfully!"):i.error(e.message||"Action failed")}catch(e){i.error(e.message)}finally{y.value=!1}};A(()=>n.params.id,s=>{s&&h(s)});async function h(s){w.value=!0;try{const e=await r.fetchTraining(s);e.t_start_date&&(e.t_start_date=e.t_start_date.split("T")[0]),e.t_end_date&&(e.t_end_date=e.t_end_date.split("T")[0]);const o={...e,t_category:e.t_category?._id||e.t_category,t_room:e.t_room?._id||e.t_room,t_eligibility:e.t_eligibility||[],t_director:e.t_director._id||e.t_director._id};Object.assign(a,o)}catch(e){i.error("Could not fetch training details"),console.error(e)}finally{w.value=!1}}const j=()=>{m.value=!0},D=async s=>{p.value=!0;try{const e=await r.updateStatus(s);e.success?(i.success(e.message),m.value=!1,await h(n.params.id)):i.warning(e.message)}catch(e){i.warning(e)}finally{p.value=!1}};return E(async()=>{await Promise.all([r.fetchCategories(),r.fetchRooms(),r.fetchGroups(),r.fetchDirectors()]);const s=n.params.id;s&&(_.value=!0,await h(s))}),(s,e)=>(b(),g("div",q,[l(L,{items:T}),t("form",{onSubmit:N(M,["prevent"]),class:"space-y-6"},[t("section",W,[t("div",Y,[e[15]||(e[15]=t("div",{class:"flex items-center gap-2 text-blue-600"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"General Information")],-1)),a.t_status==="Draft"?(b(),g("div",K,[t("button",{type:"button",onClick:j,class:"px-4 py-2 text-xs font-bold text-blue-600 bg-blue-50 hover:bg-blue-100 dark:bg-blue-500/10 dark:text-blue-400 dark:hover:bg-blue-500/20 border border-blue-200 dark:border-blue-500/30 rounded-xl transition-all active:scale-95 flex items-center gap-2"},[...e[14]||(e[14]=[t("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),f(" Mark as Upcoming ",-1)])])])):v("",!0)]),t("div",Q,[t("div",X,[l(d,{modelValue:a.t_name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.t_name=o),label:"Training Program Name",placeholder:"e.g. Advanced Cybersecurity Workshop",type:"text"},null,8,["modelValue"]),l(d,{modelValue:a.t_description,"onUpdate:modelValue":e[1]||(e[1]=o=>a.t_description=o),label:"Program Overview",placeholder:"Describe the objectives and outcomes...",type:"textarea",rows:"4"},null,8,["modelValue"])]),t("div",Z,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"},"Program Banner",-1)),l(J,{type:"file",accept:".png, .jpg, .jpeg",class:"h-[188px]",onChange:U})])])]),t("section",ee,[e[17]||(e[17]=t("div",{class:"flex items-center gap-2 mb-6 text-amber-500"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"Timeline")],-1)),t("div",te,[l(d,{modelValue:a.t_start_date,"onUpdate:modelValue":e[2]||(e[2]=o=>a.t_start_date=o),label:"Start Date",type:"date"},null,8,["modelValue"]),l(d,{modelValue:a.t_end_date,"onUpdate:modelValue":e[3]||(e[3]=o=>a.t_end_date=o),label:"End Date",type:"date"},null,8,["modelValue"])])]),t("section",ae,[e[18]||(e[18]=t("div",{class:"flex items-center gap-2 mb-6 text-emerald-500"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]),t("h2",{class:"text-lg font-bold tracking-tight"},"Training Logistics")],-1)),t("div",oe,[t("div",se,[l(d,{modelValue:a.t_organizer,"onUpdate:modelValue":e[4]||(e[4]=o=>a.t_organizer=o),label:"Organizer / Department",placeholder:"e.g. HR Department",type:"text"},null,8,["modelValue"]),l(G,{modelValue:a.t_director,"onUpdate:modelValue":e[5]||(e[5]=o=>a.t_director=o),options:u(C),label:"Training Director",placeholder:"Full Name",type:"text"},null,8,["modelValue","options"]),l(F,{modelValue:a.t_eligibility,"onUpdate:modelValue":e[6]||(e[6]=o=>a.t_eligibility=o),options:u(z),"track-by":"_id","option-label":"group_name",label:"Target Eligibility Groups",placeholder:"Select allowed groups"},null,8,["modelValue","options"])]),t("div",le,[t("div",re,[l(d,{modelValue:a.t_capacity,"onUpdate:modelValue":e[7]||(e[7]=o=>a.t_capacity=o),label:"Seat Capacity",placeholder:"50",type:"number"},null,8,["modelValue"]),l(x,{modelValue:a.t_category,"onUpdate:modelValue":e[8]||(e[8]=o=>a.t_category=o),options:u(k),"track-by":"_id","option-label":"name",label:"Category",placeholder:"Select Type"},null,8,["modelValue","options"])]),l(x,{modelValue:a.t_status,"onUpdate:modelValue":e[9]||(e[9]=o=>a.t_status=o),options:S,"track-by":"name","option-label":"value",label:"Status",placeholder:"Select Status"},null,8,["modelValue"]),l(x,{modelValue:a.t_room,"onUpdate:modelValue":e[10]||(e[10]=o=>a.t_room=o),options:u(V),"track-by":"_id","option-label":"room_name",label:"Assigned Room / Venue",placeholder:"Select Venue"},null,8,["modelValue","options"])])])]),t("div",ie,[t("button",{type:"button",onClick:e[11]||(e[11]=o=>s.$router.back()),class:"px-6 py-2.5 rounded-xl text-zinc-500 hover:bg-zinc-100 dark:hover:bg-white/5 font-semibold transition-all"}," Cancel "),e[19]||(e[19]=t("button",{type:"submit",class:"px-8 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-bold shadow-lg shadow-blue-500/30 transition-all active:scale-95"}," Update Training Program ",-1))])],32),l(H,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:O(()=>[m.value?(b(),g("div",ne,[t("div",de,[e[21]||(e[21]=t("div",{class:"p-6 text-center"},[t("div",{class:"mx-auto w-16 h-16 rounded-full bg-blue-50 dark:bg-blue-500/10 flex items-center justify-center text-blue-600 mb-4"},[t("svg",{class:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])]),t("h3",{class:"text-xl font-bold text-zinc-900 dark:text-zinc-100 mb-2"},"Change Status?"),t("p",{class:"text-sm text-zinc-500 dark:text-zinc-400 px-4"},[f(" Are you sure you want to mark this training as "),t("span",{class:"font-bold text-blue-600"},"Upcoming"),f("? This will be available to public. ")])],-1)),t("div",ue,[t("button",{onClick:e[12]||(e[12]=o=>m.value=!1),class:"flex-1 px-5 py-3 text-sm font-bold text-zinc-500 hover:bg-zinc-200 dark:hover:bg-white/5 rounded-2xl transition-all"}," Cancel "),t("button",{onClick:e[13]||(e[13]=o=>D(u(n).params.id)),disabled:p.value,class:"flex-1 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-2xl shadow-lg shadow-blue-500/20 transition-all disabled:opacity-50 flex items-center justify-center gap-2"},[p.value?(b(),g("span",me)):v("",!0),e[20]||(e[20]=f(" Yes, Confirm ",-1))],8,ce)])])])):v("",!0)]),_:1})]))}};export{ke as default};
