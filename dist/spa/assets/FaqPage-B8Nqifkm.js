import{y as U,k as c,I as m,s as i,p as e,Q as u,n as l,N as q,U as f,J as N,K as B,$ as V,a5 as E,L as k,M as w,O as Q,X as b,a6 as I,W as $,a0 as M,a7 as O,a3 as A,r,f as P,q as j}from"./index-BFQVnkeD.js";import{Q as J}from"./QForm-BT1M9ZeC.js";import{C as K}from"./ClosePopup-C7U-2yK_.js";import{u as T}from"./use-quasar-DANKxKaF.js";const W={class:"q-pa-md"},X={class:"row items-center justify-between q-mb-md"},G={class:"row q-col-gutter-md"},H={class:"text-h6 text-primary ellipsis-2-lines"},R={class:"text-caption text-grey q-mt-xs"},Y={key:0,class:"text-center q-mt-xl text-grey"},Z={key:1,class:"text-center q-my-lg"},ee={class:"text-h6 text-primary"},ne={__name:"FaqPage",setup(te){const n=T(),x=r([]),p=r(!1),g=r(""),d=r(!1),v=r(!1),y=r(null),o=r({question:"",answer:"",category:""}),C=P(()=>{if(!g.value)return x.value;const t=g.value.toLowerCase();return x.value.filter(a=>a.question.toLowerCase().includes(t)||a.answer.toLowerCase().includes(t)||a.category?.toLowerCase().includes(t))}),_=async()=>{p.value=!0;try{const t=await A.get("https://staging2.egovmz.in/admin-api/faqs");x.value=t.data.faqs||[]}catch(t){n.notify({type:"negative",message:t.response?.data?.message||"Failed to fetch FAQs"})}finally{p.value=!1}},S=t=>{n.dialog({title:t.question,message:`
      <b>Answer:</b> ${t.answer}<br/>
      <b>Category:</b> ${t.category||"â€”"}<br/>
      <b>Created At:</b> ${new Date(t.createdAt).toLocaleString()}
    `,html:!0})},z=()=>{v.value=!1,y.value=null,o.value={question:"",answer:"",category:""},d.value=!0},D=t=>{v.value=!0,y.value=t._id,o.value={question:t.question,answer:t.answer,category:t.category},d.value=!0},F=async()=>{try{v.value&&y.value?(await A.put(`https://staging2.egovmz.in/admin-api/faqs/${y.value}`,o.value),n.notify({type:"positive",message:"FAQ updated successfully"})):(await A.post("https://staging2.egovmz.in/admin-api/faqs",o.value),n.notify({type:"positive",message:"FAQ created successfully"})),d.value=!1,_()}catch(t){n.notify({type:"negative",message:t.response?.data?.message||"Operation failed"})}},L=async t=>{n.dialog({title:"Confirm",message:"Are you sure you want to delete this FAQ?",cancel:!0,persistent:!0}).onOk(async()=>{try{await A.delete(`https://staging2.egovmz.in/admin-api/faqs/${t}`),n.notify({type:"positive",message:"FAQ deleted successfully"}),_()}catch(a){n.notify({type:"negative",message:a.response?.data?.message||"Failed to delete FAQ"})}})};return U(_),(t,a)=>(c(),m("div",W,[i("div",X,[a[5]||(a[5]=i("div",{class:"text-h5 text-primary text-weight-bold"},"Frequently Asked Questions",-1)),e(u,{color:"primary",icon:"add",label:"Add FAQ",onClick:z})]),e(f,{dense:"",outlined:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=s=>g.value=s),placeholder:"Search FAQs...",class:"q-mb-lg"},{append:l(()=>[e(q,{name:"search"})]),_:1},8,["modelValue"]),i("div",G,[(c(!0),m(N,null,B(C.value,s=>(c(),m("div",{key:s._id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[e(k,{bordered:"",flat:"",class:"faq-card"},{default:l(()=>[e(w,null,{default:l(()=>[i("div",H,Q(s.question),1),i("div",R,Q(s.category||"Uncategorized"),1)]),_:2},1024),e(b),e(w,{class:"text-body2 text-grey-8 ellipsis-3-lines"},{default:l(()=>[j(Q(s.answer),1)]),_:2},1024),e(b),e($,{align:"around"},{default:l(()=>[e(u,{dense:"",flat:"",color:"primary",icon:"visibility",onClick:h=>S(s)},null,8,["onClick"]),e(u,{dense:"",flat:"",color:"orange",icon:"edit",onClick:h=>D(s)},null,8,["onClick"]),e(u,{dense:"",flat:"",color:"negative",icon:"delete",onClick:h=>L(s._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),!C.value.length&&!p.value?(c(),m("div",Y,[e(q,{name:"help_outline",size:"56px",color:"grey-5"}),a[6]||(a[6]=i("div",{class:"text-subtitle1 q-mt-sm"},"No FAQs found",-1))])):V("",!0),p.value?(c(),m("div",Z,[e(E,{color:"primary",size:"40px"})])):V("",!0),e(O,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=s=>d.value=s),persistent:""},{default:l(()=>[e(k,{style:{"min-width":"600px"},class:"q-pa-md"},{default:l(()=>[e(w,null,{default:l(()=>[i("div",ee,Q(v.value?"Edit FAQ":"Add FAQ"),1)]),_:1}),e(b),e(w,null,{default:l(()=>[e(J,{onSubmit:I(F,["prevent"]),class:"q-gutter-md"},{default:l(()=>[e(f,{modelValue:o.value.question,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.question=s),label:"Question",outlined:"",dense:"",required:""},null,8,["modelValue"]),e(f,{modelValue:o.value.answer,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.answer=s),label:"Answer",type:"textarea",outlined:"",dense:"",required:"",autogrow:""},null,8,["modelValue"]),e(f,{modelValue:o.value.category,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.category=s),label:"Category",outlined:"",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),e($,{align:"right"},{default:l(()=>[M(e(u,{flat:"",label:"Cancel",color:"negative"},null,512),[[K]]),e(u,{flat:"",label:"Save",color:"primary",onClick:F})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ne as default};
