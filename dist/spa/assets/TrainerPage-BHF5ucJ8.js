import{y as j,k as i,I as b,s as r,p as l,Q as _,n as s,N as $,U as m,J as A,K as L,L as S,M as x,O as n,X as C,a6 as z,m as p,$ as c,a0 as J,a7 as K,a3 as q,r as d,T as O,q as f}from"./index-BmtaoebC.js";import{Q as D}from"./QItemLabel-CIkYOKvx.js";import{Q as T}from"./QChip-BopL0Lgn.js";import{Q as X}from"./QPagination-rR4NmVMh.js";import{Q as G}from"./QSelect-fpzyl7lR.js";import{Q as H}from"./QForm-DR8dK1jU.js";import{C as R}from"./ClosePopup-xY3rlSpy.js";import{u as W}from"./use-quasar-BWiFnQ-9.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-DyQxkAtJ.js";import"./QItemSection-BFHoprD4.js";import"./QMenu-cxHhfpYg.js";import"./position-engine-BccdHKPO.js";import"./selection-YkbmM9Dm.js";import"./rtl-DFPa-2ov.js";const Z={class:"q-pa-md"},ee={class:"row justify-between items-center q-mb-md"},ae={class:"row q-gutter-md"},le=["src"],te={class:"column"},oe={class:"text-h6 text-primary"},se={class:"text-subtitle2"},ie={key:1,class:"q-mt-sm"},re={class:"row justify-center q-mt-md"},ne={class:"text-h6 text-primary"},de={class:"row justify-end q-gutter-sm"},ue={__name:"TrainerPage",setup(me){const v=W(),w=d([]),k=d([]),V=d(!1),Q=d(!1),P=d(""),g=d(!1),o=d({full_name:"",email:"",password:"",mobile:"",department:null,designation:"",district:[],roles:[]}),u=d({page:1,limit:10,totalPages:1});async function y(){try{const t=await q.get(`/admin-api/trainers?search=${P.value}&page=${u.value.page}&limit=${u.value.limit}`);w.value=t.data.trainers||[],u.value.totalPages=t.data.pagination?.totalPages||1}catch(t){console.error(t)}}async function N(){try{const t=await q.get("/admin-api/departments?limit=100");k.value=t.data.departments||[]}catch(t){console.error(t)}}const E=t=>{const a=k.value.find(e=>e._id===t);return a?a.name:"-"};function F(){u.value.page=1,y()}function h(t=null){t?(g.value=!0,o.value={full_name:t.full_name,email:t.email,password:"",mobile:t.mobile,department:t.department||null,designation:t.designation,district:t.district||[],roles:t.roles||[]}):(g.value=!1,U()),V.value=!0}function U(){o.value={full_name:"",email:"",password:"",mobile:"",department:null,designation:"",district:[],roles:[]}}async function B(){Q.value=!0;try{if(g.value){const t=w.value.find(a=>a.email===o.value.email);await q.put(`/admin-api/trainer/${t._id}`,o.value)}else await q.post("/admin-api/trainer",o.value);v.notify({type:"positive",message:"Trainer saved successfully!"}),V.value=!1,U(),y()}catch(t){console.error(t),v.notify({type:"negative",message:"Failed to save trainer."})}finally{Q.value=!1}}async function I(t){try{if(!await v.dialog({title:"Confirm Delete",message:"Are you sure you want to delete this trainer?",cancel:!0,persistent:!0}))return;await q.delete(`/admin-api/trainer/${t}`),v.notify({type:"positive",message:"Trainer deleted successfully!"}),y()}catch(a){console.error(a),v.notify({type:"negative",message:"Failed to delete trainer."})}}return j(()=>{N(),y()}),(t,a)=>(i(),b("div",Z,[r("div",ee,[l(_,{color:"primary",icon:"add",label:"Add Trainer",onClick:a[0]||(a[0]=e=>h()),unelevated:""}),l(m,{dense:"",debounce:"300",modelValue:P.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>P.value=e),F],placeholder:"Search trainers...",outlined:"",clearable:"",class:"col-xs-12 col-sm-6 col-md-4"},{append:s(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),r("div",ae,[(i(!0),b(A,null,L(w.value,e=>(i(),b("div",{key:e._id,class:"col-xs-12 col-sm-6 col-md-4"},[l(S,{class:"shadow-2 hover-card rounded-borders"},{default:s(()=>[l(x,{class:"row items-center q-pb-sm bg-primary text-white"},{default:s(()=>[l(O,{size:"60px",class:"q-mr-md"},{default:s(()=>[e.trainerProfile?.profile_picture?(i(),b("img",{key:0,src:"https://staging2.egovmz.in"+e.trainerProfile.profile_picture,alt:"Profile"},null,8,le)):(i(),p($,{key:1,name:"person",size:"40px",color:""}))]),_:2},1024),r("div",te,[r("div",oe,n(e.full_name),1),r("div",se,n(e.email),1)])]),_:2},1024),l(C),l(x,{class:"q-pt-sm q-pb-sm"},{default:s(()=>[l(D,{class:"q-mb-xs"},{default:s(()=>[a[10]||(a[10]=r("strong",null,"Mobile:",-1)),f(" "+n(e.mobile),1)]),_:2},1024),l(D,{class:"q-mb-xs"},{default:s(()=>[a[11]||(a[11]=r("strong",null,"Designation:",-1)),f(" "+n(e.designation),1)]),_:2},1024),e.department?(i(),p(D,{key:0,class:"q-mb-xs"},{default:s(()=>[a[12]||(a[12]=r("strong",null,"Department:",-1)),f(" "+n(E(e.department)),1)]),_:2},1024)):c("",!0),e.trainerProfile?(i(),b("div",ie,[e.trainerProfile.expertise?(i(),p(T,{key:0,dense:"",outline:"",color:"secondary","text-color":"dark",class:"q-mr-xs q-mb-xs"},{default:s(()=>[f(" Expertise: "+n(e.trainerProfile.expertise),1)]),_:2},1024)):c("",!0),e.trainerProfile.qualification?(i(),p(T,{key:1,dense:"",outline:"",color:"primary","text-color":"dark",class:"q-mr-xs q-mb-xs"},{default:s(()=>[f(" Qualification: "+n(e.trainerProfile.qualification),1)]),_:2},1024)):c("",!0),e.trainerProfile.experience?(i(),p(T,{key:2,dense:"",outline:"",color:"accent","text-color":"dark",class:"q-mr-xs q-mb-xs"},{default:s(()=>[f(" Experience: "+n(e.trainerProfile.experience),1)]),_:2},1024)):c("",!0)])):c("",!0)]),_:2},1024),l(C),l(x,{class:"row justify-end q-gutter-sm"},{default:s(()=>[l(_,{flat:"",icon:"edit",color:"primary",label:"Edit",onClick:M=>h(e)},null,8,["onClick"]),l(_,{flat:"",icon:"delete",color:"negative",label:"Delete",onClick:M=>I(e._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),r("div",re,[l(X,{modelValue:u.value.page,"onUpdate:modelValue":[a[2]||(a[2]=e=>u.value.page=e),y],max:u.value.totalPages,"boundary-numbers":"",input:"",color:"primary"},null,8,["modelValue","max"])]),l(K,{modelValue:V.value,"onUpdate:modelValue":a[9]||(a[9]=e=>V.value=e),persistent:""},{default:s(()=>[l(S,{class:"q-pa-md",style:{"min-width":"500px"}},{default:s(()=>[l(x,null,{default:s(()=>[r("div",ne,n(g.value?"Edit Trainer":"Add New Trainer"),1)]),_:1}),l(C),l(x,null,{default:s(()=>[l(H,{onSubmit:z(B,["prevent"]),class:"q-gutter-md"},{default:s(()=>[l(m,{modelValue:o.value.full_name,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.full_name=e),label:"Full Name",outlined:"",required:""},null,8,["modelValue"]),l(m,{modelValue:o.value.email,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.email=e),label:"Email",outlined:"",type:"email",required:""},null,8,["modelValue"]),g.value?c("",!0):(i(),p(m,{key:0,modelValue:o.value.password,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.password=e),label:"Password",outlined:"",type:"password",required:""},null,8,["modelValue"])),l(m,{modelValue:o.value.mobile,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.mobile=e),label:"Mobile",outlined:"",required:""},null,8,["modelValue"]),l(G,{modelValue:o.value.department,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value.department=e),options:k.value.map(e=>({label:e.name,value:e._id})),label:"Select Department",outlined:"","emit-value":"","map-options":"",required:""},null,8,["modelValue","options"]),l(m,{modelValue:o.value.designation,"onUpdate:modelValue":a[8]||(a[8]=e=>o.value.designation=e),label:"Designation",outlined:"",required:""},null,8,["modelValue"]),r("div",de,[J(l(_,{flat:"",label:"Cancel",color:"negative"},null,512),[[R]]),l(_,{type:"submit",label:"Save",color:"primary",loading:Q.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},Ce=Y(ue,[["__scopeId","data-v-4ddcbdfb"]]);export{Ce as default};
