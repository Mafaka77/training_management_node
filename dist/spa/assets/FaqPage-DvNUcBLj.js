import{J as j,k as m,W as p,s as n,p as a,Q as u,n as l,$ as S,a5 as F,X as M,Y as J,ac as $,al as T,Z as L,_ as C,a0 as _,a8 as V,aj as W,q as U,a7 as z,ad as X,ai as Y,r,ag as b,f as D}from"./index-Bzn0LiPU.js";import{Q as N}from"./QSelect-ChM7-dt3.js";import{Q as Z,a as G}from"./QItemSection-COOhA9zR.js";import{Q as H}from"./QForm-FpFFQh9P.js";import{C as K}from"./ClosePopup-C6H1DDOC.js";import{u as R}from"./use-quasar-CLO-DOJZ.js";import"./QChip-COUtrNlO.js";import"./QItemLabel-BQHMT6Ru.js";import"./QMenu-2e4m313B.js";import"./position-engine-BCFNfW53.js";import"./selection-DFkNIa7B.js";import"./rtl-DFPa-2ov.js";import"./format-DyQxkAtJ.js";const ee={class:"q-pa-md"},te={class:"row items-center justify-between q-mb-md"},ae={class:"row q-col-gutter-md q-mb-lg"},se={class:"col-12 col-md-8"},le={class:"col-12 col-md-4"},oe={class:"row q-col-gutter-md"},ne=["onClick"],ie={class:"text-caption text-grey q-mt-xs"},re={key:0,class:"text-center q-mt-xl text-grey"},ue={key:1,class:"text-center q-my-lg"},de={class:"text-h6 text-primary"},Fe={__name:"FaqPage",setup(ce){const i=R(),g=r([]),v=r(!1),y=r(""),f=r(null),d=r(!1),w=r(!1),Q=r(null),o=r({question:"",answer:"",category:""}),x=D(()=>[...new Set(g.value.map(t=>t.category).filter(Boolean))]),B=t=>{if(!t)return;const e=t.trim();if(!e)return;x.value.some(c=>c.toLowerCase()===e.toLowerCase())||g.value.push({category:e}),o.value.category=e},E=t=>t?.trim().replace(/\s+/g," ").replace(/\b\w/g,e=>e.toUpperCase());o.value.category=E(o.value.category);const h=D(()=>{let t=g.value;if(f.value&&(t=t.filter(e=>e.category===f.value)),y.value){const e=y.value.toLowerCase();t=t.filter(s=>s.question.toLowerCase().includes(e)||s.answer.toLowerCase().includes(e)||s.category?.toLowerCase().includes(e))}return t}),A=async()=>{v.value=!0;try{const t=await b.get("/admin-api/faqs");g.value=t.data.faqs||[]}catch(t){i.notify({type:"negative",message:t.response?.data?.message||"Failed to fetch FAQs"})}finally{v.value=!1}},q=t=>{i.dialog({title:t.question,message:`
      <b>Answer:</b> ${t.answer}<br/>
      <b>Category:</b> ${t.category||"â€”"}<br/>
      <b>Created At:</b> ${new Date(t.createdAt).toLocaleString()}
    `,html:!0})},I=()=>{w.value=!1,Q.value=null,o.value={question:"",answer:"",category:""},d.value=!0},O=t=>{w.value=!0,Q.value=t._id,o.value={question:t.question,answer:t.answer,category:t.category},d.value=!0},k=async()=>{try{w.value&&Q.value?(await b.put(`https://staging2.egovmz.in/admin-api/faqs/${Q.value}`,o.value),i.notify({type:"positive",message:"FAQ updated successfully"})):(await b.post("https://staging2.egovmz.in/admin-api/faqs",o.value),i.notify({type:"positive",message:"FAQ created successfully"})),d.value=!1,A()}catch(t){i.notify({type:"negative",message:t.response?.data?.message||"Operation failed"})}},P=async t=>{i.dialog({title:"Confirm",message:"Are you sure you want to delete this FAQ?",cancel:!0,persistent:!0}).onOk(async()=>{try{await b.delete(`https://staging2.egovmz.in/admin-api/faqs/${t}`),i.notify({type:"positive",message:"FAQ deleted successfully"}),A()}catch(e){i.notify({type:"negative",message:e.response?.data?.message||"Failed to delete FAQ"})}})};return j(A),(t,e)=>(m(),p("div",ee,[n("div",te,[e[6]||(e[6]=n("div",{class:"text-h5 text-primary text-weight-bold"},"Frequently Asked Questions",-1)),a(u,{color:"primary",icon:"add",label:"Add FAQ",onClick:I})]),n("div",ae,[n("div",se,[a(F,{dense:"",outlined:"",debounce:"300",modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),placeholder:"Search FAQs..."},{append:l(()=>[a(S,{name:"search"})]),_:1},8,["modelValue"])]),n("div",le,[a(N,{dense:"",outlined:"",clearable:"",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),options:x.value,label:"Filter by Category"},null,8,["modelValue","options"])])]),n("div",oe,[(m(!0),p(M,null,J(h.value,s=>(m(),p("div",{key:s._id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[a(L,{bordered:"",flat:"",class:"faq-card"},{default:l(()=>[a(C,null,{default:l(()=>[n("div",{class:"text-h6 text-primary ellipsis-2-lines cursor-pointer",onClick:c=>q(s)},_(s.question),9,ne),n("div",ie,_(s.category||"Uncategorized"),1)]),_:2},1024),a(V),a(C,{class:"text-body2 text-grey-8 ellipsis-3-lines"},{default:l(()=>[U(_(s.answer),1)]),_:2},1024),a(V),a(z,{align:"around"},{default:l(()=>[a(u,{dense:"",flat:"",color:"primary",icon:"visibility",onClick:c=>q(s)},null,8,["onClick"]),a(u,{dense:"",flat:"",color:"orange",icon:"edit",onClick:c=>O(s)},null,8,["onClick"]),a(u,{dense:"",flat:"",color:"negative",icon:"delete",onClick:c=>P(s._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),!h.value.length&&!v.value?(m(),p("div",re,[a(S,{name:"help_outline",size:"56px",color:"grey-5"}),e[7]||(e[7]=n("div",{class:"text-subtitle1 q-mt-sm"},"No FAQs found",-1))])):$("",!0),v.value?(m(),p("div",ue,[a(T,{color:"primary",size:"40px"})])):$("",!0),a(Y,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=s=>d.value=s),persistent:""},{default:l(()=>[a(L,{style:{"min-width":"600px"},class:"q-pa-md"},{default:l(()=>[a(C,null,{default:l(()=>[n("div",de,_(w.value?"Edit FAQ":"Add FAQ"),1)]),_:1}),a(V),a(C,null,{default:l(()=>[a(H,{onSubmit:W(k,["prevent"]),class:"q-gutter-md"},{default:l(()=>[a(F,{modelValue:o.value.question,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.question=s),label:"Question",outlined:"",dense:"",required:""},null,8,["modelValue"]),a(F,{modelValue:o.value.answer,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.answer=s),label:"Answer",type:"textarea",outlined:"",dense:"",required:"",autogrow:""},null,8,["modelValue"]),a(N,{modelValue:o.value.category,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.category=s),options:x.value,label:"Category",outlined:"",dense:"","use-input":"",clearable:"","hide-dropdown-icon":"",onNewValue:B,hint:"Select existing or type to add new"},{"no-option":l(()=>[a(Z,null,{default:l(()=>[a(G,{class:"text-grey"},{default:l(()=>[...e[8]||(e[8]=[U(" Press Enter to add new category ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),_:1})]),_:1}),a(z,{align:"right"},{default:l(()=>[X(a(u,{flat:"",label:"Cancel",color:"negative"},null,512),[[K]]),a(u,{flat:"",label:"Save",color:"primary",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Fe as default};
