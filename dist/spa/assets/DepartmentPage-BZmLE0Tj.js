import{y as F,k as m,I as u,s as o,p as e,Q as d,J as N,K as $,N as A,$ as E,n,L as x,M as y,O as _,X as C,U as S,W as h,a0 as B,a7 as I,a3 as p,r as v}from"./index-CMgzUS9v.js";import{C as L}from"./ClosePopup-DOU4H43s.js";import{u as P}from"./use-quasar-DLMUNkT4.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"q-pa-md"},j={class:"flex justify-between items-center q-mb-md"},z={class:"row q-col-gutter-md"},J={class:"text-h6 text-primary"},K={class:"text-caption text-grey q-mt-xs"},O={key:0,class:"text-center text-grey q-my-xl"},T={class:"text-h6 text-primary"},W={__name:"DepartmentPage",setup(X){const r=P(),f=v([]),i=v(!1),c=v(!1),l=v({_id:null,name:""}),g=async()=>{try{const t=await p.get("/admin/departments");f.value=t.data?.departments||[]}catch(t){console.error("Failed to fetch categories:",t)}},w=async()=>{try{c.value&&l.value._id?(await p.put(`/admin/department/${l.value._id}`,{name:l.value.name}),r.notify({type:"positive",message:"Department updated successfully"})):(await p.post("/admin/department",{name:l.value.name}),r.notify({type:"positive",message:"Department added successfully"})),i.value=!1,g(),D()}catch(t){console.error("Failed to save category:",t),r.notify({type:"negative",message:"Failed to save department"})}},b=async t=>{try{const a=await p.delete(`/admin/department/${t}`);a.data?.status===200&&(r.notify({type:"positive",message:a.data?.message||"Department deleted successfully"}),g())}catch(a){console.error("Delete failed:",a),r.notify({type:"negative",message:"Failed to delete department"})}},k=()=>{D(),c.value=!1,i.value=!0},q=t=>{l.value={_id:t._id,name:t.name},c.value=!0,i.value=!0},D=()=>{l.value={_id:null,name:""}},Q=t=>t?new Date(t).toLocaleDateString():"-";return F(g),(t,a)=>(m(),u("div",M,[o("div",j,[a[2]||(a[2]=o("div",{class:"text-h6 text-primary"},"Training Departments",-1)),e(d,{color:"primary",label:"Add Department",icon:"add",onClick:k})]),o("div",z,[(m(!0),u(N,null,$(f.value,s=>(m(),u("div",{key:s._id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[e(x,{class:"shadow-3 rounded-borders hover-card"},{default:n(()=>[e(y,{class:"text-center q-pt-md q-pb-sm"},{default:n(()=>[o("div",J,_(s.name),1),o("div",K," Created on: "+_(Q(s.createdAt)),1)]),_:2},1024),e(C),e(h,{align:"around"},{default:n(()=>[e(d,{dense:"",flat:"",color:"primary",icon:"edit",label:"Edit",onClick:V=>q(s)},null,8,["onClick"]),e(d,{dense:"",flat:"",color:"negative",icon:"delete",label:"Delete",onClick:V=>b(s._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),f.value.length?E("",!0):(m(),u("div",O,[e(A,{name:"warning",size:"40px",color:"grey-6"}),a[3]||(a[3]=o("div",{class:"text-subtitle2 q-mt-sm"},"No departments found.",-1))])),e(I,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),persistent:""},{default:n(()=>[e(x,{style:{"min-width":"400px"},class:"q-pa-md"},{default:n(()=>[e(y,null,{default:n(()=>[o("div",T,_(c.value?"Edit Department":"Add Department"),1)]),_:1}),e(C),e(y,{class:"q-gutter-md"},{default:n(()=>[e(S,{modelValue:l.value.name,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.name=s),label:"Department Name",outlined:""},null,8,["modelValue"])]),_:1}),e(h,{align:"right"},{default:n(()=>[B(e(d,{flat:"",label:"Cancel",color:"negative"},null,512),[[L]]),e(d,{label:"Save",color:"primary",onClick:w})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},Z=U(W,[["__scopeId","data-v-116b83a6"]]);export{Z as default};
