import{Q as M}from"./QBadge-CCt-JOPv.js";import{J as O,ag as g,k as j,W as F,s as i,q as d,p as t,n as l,a0 as u,$ as q,a5 as m,Q as v,a8 as S,Z as C,_ as D,ad as N,aj as h,ai as z,r as n,f as T}from"./index-Bzn0LiPU.js";import{Q as _}from"./QTd-Bjv19h1_.js";import{Q as G}from"./QTable-C7Me2Ftf.js";import{Q as J}from"./QSpace-BcajTR04.js";import{Q as P}from"./QSelect-ChM7-dt3.js";import{Q as L}from"./QForm-FpFFQh9P.js";import{C as U}from"./ClosePopup-C6H1DDOC.js";import{u as W}from"./use-quasar-CLO-DOJZ.js";import"./QList-BSRIgFgv.js";import"./QLinearProgress-DAd5lNjJ.js";import"./use-fullscreen-2nc3m1XY.js";import"./QChip-COUtrNlO.js";import"./QItemSection-COOhA9zR.js";import"./QItemLabel-BQHMT6Ru.js";import"./QMenu-2e4m313B.js";import"./position-engine-BCFNfW53.js";import"./selection-DFkNIa7B.js";import"./rtl-DFPa-2ov.js";import"./format-DyQxkAtJ.js";const Z={class:"q-pa-md"},H={class:"row items-center q-mb-md"},K={class:"col"},X={class:"text-h4 text-weight-bold"},Y={class:"col-auto row items-center q-gutter-sm"},ee={class:"text-weight-medium"},ae={class:"text-caption text-grey-7"},te={class:"text-caption text-grey-7"},le={class:"full-width row flex-center q-pa-lg text-grey"},oe={class:"row q-col-gutter-sm"},se={class:"row justify-end q-gutter-sm q-mt-md"},De={__name:"TrainingCoursePage",setup(ie){const R=W(),V=n([]),y=n([]),Q=n([]),f=n(!1),b=n(!1),w=n(""),p=n(!1),r=n({page:1,rowsPerPage:10,rowsNumber:0}),o=n({tc_topic:"",tc_description:"",tc_start_time:"",tc_end_time:"",tc_session:1,t_program:null,trainer:null}),k=[{name:"topic",label:"TOPIC",align:"left"},{name:"dates",label:"DATES",align:"left"},{name:"tc_session",label:"SESSIONS",field:"tc_session",align:"center"},{name:"program",label:"PROGRAM",align:"left"},{name:"trainer",label:"TRAINER",align:"left"}],$=T(()=>y.value.map(s=>({label:s.t_name,value:s._id}))),A=T(()=>Q.value.map(s=>({label:s.full_name,value:s._id}))),x=s=>new Date(s).toLocaleDateString();async function c(){f.value=!0;const{page:s,rowsPerPage:a}=r.value,e=await g.get(`/admin-api/get-all-training-course?page=${s}&limit=${a}&search=${w.value}`);V.value=e.data.courses||[],r.value.rowsNumber=e.data.total||0,f.value=!1}function B(s){r.value=s.pagination,c()}function E(){r.value.page=1,c()}async function I(){b.value=!0,await g.post("/admin-api/submit-training-course",{...o.value}),R.notify({type:"positive",message:"Course added successfully"}),p.value=!1,b.value=!1,o.value={tc_topic:"",tc_description:"",tc_start_time:"",tc_end_time:"",tc_session:1,t_program:null,trainer:null},c()}return O(async()=>{const[s,a]=await Promise.all([g.get("/admin-api/get-all-training-program?page=1&limit=100"),g.get("/admin-api/get-trainer")]);y.value=s.data.programs||[],Q.value=a.data.trainers||[],c()}),(s,a)=>(j(),F("div",Z,[i("div",H,[i("div",K,[i("div",X,[a[11]||(a[11]=d(" Training Courses ",-1)),t(M,{outline:"",color:"primary",class:"q-ml-sm"},{default:l(()=>[d(u(r.value.rowsNumber),1)]),_:1})]),a[12]||(a[12]=i("div",{class:"text-caption text-grey"}," Manage all training courses ",-1))]),i("div",Y,[t(m,{dense:"",outlined:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>w.value=e),E],placeholder:"Search courses...",clearable:""},{append:l(()=>[t(q,{name:"search"})]),_:1},8,["modelValue"]),t(v,{color:"primary",icon:"add",label:"Add Course",onClick:a[1]||(a[1]=e=>p.value=!0)})])]),t(S,{class:"q-mb-md"}),t(C,{flat:"",bordered:""},{default:l(()=>[t(G,{flat:"",bordered:"","row-key":"_id",class:"sticky-header-table",rows:V.value,columns:k,loading:f.value,pagination:r.value,"onUpdate:pagination":a[2]||(a[2]=e=>r.value=e),onRequest:B,"no-data-label":"No courses found"},{"body-cell-topic":l(e=>[t(_,{props:e},{default:l(()=>[i("div",ee,u(e.row.tc_topic),1),i("div",ae,u(e.row.tc_description||"No description"),1)]),_:2},1032,["props"])]),"body-cell-dates":l(e=>[t(_,{props:e},{default:l(()=>[d(u(x(e.row.tc_start_time))+" ",1),i("div",te," to "+u(x(e.row.tc_end_time)),1)]),_:2},1032,["props"])]),"body-cell-program":l(e=>[t(_,{props:e},{default:l(()=>[d(u(e.row.t_program?.t_name||"—"),1)]),_:2},1032,["props"])]),"body-cell-trainer":l(e=>[t(_,{props:e},{default:l(()=>[d(u(e.row.trainer?.full_name||"—"),1)]),_:2},1032,["props"])]),"no-data":l(()=>[i("div",le,[t(q,{name:"school",size:"md",class:"q-mr-sm"}),a[13]||(a[13]=d(" No training courses available ",-1))])]),_:1},8,["rows","loading","pagination"])]),_:1}),t(z,{modelValue:p.value,"onUpdate:modelValue":a[10]||(a[10]=e=>p.value=e),persistent:""},{default:l(()=>[t(C,{style:{"min-width":"520px"},class:"q-pa-md"},{default:l(()=>[t(D,{class:"row items-center q-pb-none"},{default:l(()=>[a[14]||(a[14]=i("div",{class:"text-h6 text-primary"},"Add Course",-1)),t(J),N(t(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[U]])]),_:1}),t(S),t(D,null,{default:l(()=>[t(L,{onSubmit:h(I,["prevent"]),class:"q-gutter-md"},{default:l(()=>[t(m,{modelValue:o.value.tc_topic,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.tc_topic=e),label:"Topic",outlined:"",required:""},null,8,["modelValue"]),t(m,{modelValue:o.value.tc_description,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.tc_description=e),label:"Description",type:"textarea",outlined:""},null,8,["modelValue"]),i("div",oe,[t(m,{class:"col-6",type:"date",modelValue:o.value.tc_start_time,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.tc_start_time=e),label:"Start Date",outlined:""},null,8,["modelValue"]),t(m,{class:"col-6",type:"date",modelValue:o.value.tc_end_time,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.tc_end_time=e),label:"End Date",outlined:""},null,8,["modelValue"])]),t(m,{modelValue:o.value.tc_session,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value.tc_session=e),modelModifiers:{number:!0},label:"Sessions",type:"number",outlined:"",min:"1"},null,8,["modelValue"]),t(P,{modelValue:o.value.t_program,"onUpdate:modelValue":a[8]||(a[8]=e=>o.value.t_program=e),options:$.value,label:"Training Program",outlined:"","emit-value":"","map-options":""},null,8,["modelValue","options"]),t(P,{modelValue:o.value.trainer,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value.trainer=e),options:A.value,label:"Trainer",outlined:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"]),i("div",se,[N(t(v,{flat:"",label:"Cancel"},null,512),[[U]]),t(v,{color:"primary",label:"Save",type:"submit",loading:b.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{De as default};
