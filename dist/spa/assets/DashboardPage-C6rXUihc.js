import{y as it,w as pt,k as V,I as ft,s as d,r as Y,a3 as E,m as rt,n as $,p as c,L as P,M as K,N as H,O as R,J as vt,K as $t,q as nt,$ as _t,f as yt}from"./index-05LJQMJY.js";import{Q as lt,a as X}from"./QItemSection-CaYh8A0-.js";import{Q as Dt}from"./QList-B_jwLyLT.js";import{Q as Mt}from"./QPage-Cy0K29gO.js";import{C as ct,B as bt,c as xt,d as wt,L as St,p as Ot,a as kt,b as qt}from"./chart-BAfJ5Diy.js";import{_ as Ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";function Yt(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var tt={exports:{}},Tt=tt.exports,dt;function At(){return dt||(dt=1,(function(w,I){(function(x,_){w.exports=_()})(Tt,(function(){var x=1e3,_=6e4,q=36e5,T="millisecond",S="second",O="minute",k="hour",C="day",N="week",f="month",u="quarter",h="year",g="date",Q="Invalid Date",M=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,mt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ht={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var s=["th","st","nd","rd"],t=n%100;return"["+n+(s[(t-20)%10]||s[t]||s[0])+"]"}},et=function(n,s,t){var r=String(n);return!r||r.length>=s?n:""+Array(s+1-r.length).join(t)+n},gt={s:et,z:function(n){var s=-n.utcOffset(),t=Math.abs(s),r=Math.floor(t/60),e=t%60;return(s<=0?"+":"-")+et(r,2,"0")+":"+et(e,2,"0")},m:function n(s,t){if(s.date()<t.date())return-n(t,s);var r=12*(t.year()-s.year())+(t.month()-s.month()),e=s.clone().add(r,f),a=t-e<0,i=s.clone().add(r+(a?-1:1),f);return+(-(r+(t-e)/(a?e-i:i-e))||0)},a:function(n){return n<0?Math.ceil(n)||0:Math.floor(n)},p:function(n){return{M:f,y:h,w:N,d:C,D:g,h:k,m:O,s:S,ms:T,Q:u}[n]||String(n||"").toLowerCase().replace(/s$/,"")},u:function(n){return n===void 0}},W="en",L={};L[W]=ht;var ot="$isDayjsObject",st=function(n){return n instanceof Z||!(!n||!n[ot])},J=function n(s,t,r){var e;if(!s)return W;if(typeof s=="string"){var a=s.toLowerCase();L[a]&&(e=a),t&&(L[a]=t,e=a);var i=s.split("-");if(!e&&i.length>1)return n(i[0])}else{var l=s.name;L[l]=s,e=l}return!r&&e&&(W=e),e||!r&&W},p=function(n,s){if(st(n))return n.clone();var t=typeof s=="object"?s:{};return t.date=n,t.args=arguments,new Z(t)},o=gt;o.l=J,o.i=st,o.w=function(n,s){return p(n,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var Z=(function(){function n(t){this.$L=J(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[ot]=!0}var s=n.prototype;return s.parse=function(t){this.$d=(function(r){var e=r.date,a=r.utc;if(e===null)return new Date(NaN);if(o.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var i=e.match(M);if(i){var l=i[2]-1||0,m=(i[7]||"0").substring(0,3);return a?new Date(Date.UTC(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,m)):new Date(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,m)}}return new Date(e)})(t),this.init()},s.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},s.$utils=function(){return o},s.isValid=function(){return this.$d.toString()!==Q},s.isSame=function(t,r){var e=p(t);return this.startOf(r)<=e&&e<=this.endOf(r)},s.isAfter=function(t,r){return p(t)<this.startOf(r)},s.isBefore=function(t,r){return this.endOf(r)<p(t)},s.$g=function(t,r,e){return o.u(t)?this[r]:this.set(e,t)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(t,r){var e=this,a=!!o.u(r)||r,i=o.p(t),l=function(z,D){var A=o.w(e.$u?Date.UTC(e.$y,D,z):new Date(e.$y,D,z),e);return a?A:A.endOf(C)},m=function(z,D){return o.w(e.toDate()[z].apply(e.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(D)),e)},v=this.$W,y=this.$M,b=this.$D,B="set"+(this.$u?"UTC":"");switch(i){case h:return a?l(1,0):l(31,11);case f:return a?l(1,y):l(0,y+1);case N:var j=this.$locale().weekStart||0,U=(v<j?v+7:v)-j;return l(a?b-U:b+(6-U),y);case C:case g:return m(B+"Hours",0);case k:return m(B+"Minutes",1);case O:return m(B+"Seconds",2);case S:return m(B+"Milliseconds",3);default:return this.clone()}},s.endOf=function(t){return this.startOf(t,!1)},s.$set=function(t,r){var e,a=o.p(t),i="set"+(this.$u?"UTC":""),l=(e={},e[C]=i+"Date",e[g]=i+"Date",e[f]=i+"Month",e[h]=i+"FullYear",e[k]=i+"Hours",e[O]=i+"Minutes",e[S]=i+"Seconds",e[T]=i+"Milliseconds",e)[a],m=a===C?this.$D+(r-this.$W):r;if(a===f||a===h){var v=this.clone().set(g,1);v.$d[l](m),v.init(),this.$d=v.set(g,Math.min(this.$D,v.daysInMonth())).$d}else l&&this.$d[l](m);return this.init(),this},s.set=function(t,r){return this.clone().$set(t,r)},s.get=function(t){return this[o.p(t)]()},s.add=function(t,r){var e,a=this;t=Number(t);var i=o.p(r),l=function(y){var b=p(a);return o.w(b.date(b.date()+Math.round(y*t)),a)};if(i===f)return this.set(f,this.$M+t);if(i===h)return this.set(h,this.$y+t);if(i===C)return l(1);if(i===N)return l(7);var m=(e={},e[O]=_,e[k]=q,e[S]=x,e)[i]||1,v=this.$d.getTime()+t*m;return o.w(v,this)},s.subtract=function(t,r){return this.add(-1*t,r)},s.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||Q;var a=t||"YYYY-MM-DDTHH:mm:ssZ",i=o.z(this),l=this.$H,m=this.$m,v=this.$M,y=e.weekdays,b=e.months,B=e.meridiem,j=function(D,A,F,G){return D&&(D[A]||D(r,a))||F[A].slice(0,G)},U=function(D){return o.s(l%12||12,D,"0")},z=B||function(D,A,F){var G=D<12?"AM":"PM";return F?G.toLowerCase():G};return a.replace(mt,(function(D,A){return A||(function(F){switch(F){case"YY":return String(r.$y).slice(-2);case"YYYY":return o.s(r.$y,4,"0");case"M":return v+1;case"MM":return o.s(v+1,2,"0");case"MMM":return j(e.monthsShort,v,b,3);case"MMMM":return j(b,v);case"D":return r.$D;case"DD":return o.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return j(e.weekdaysMin,r.$W,y,2);case"ddd":return j(e.weekdaysShort,r.$W,y,3);case"dddd":return y[r.$W];case"H":return String(l);case"HH":return o.s(l,2,"0");case"h":return U(1);case"hh":return U(2);case"a":return z(l,m,!0);case"A":return z(l,m,!1);case"m":return String(m);case"mm":return o.s(m,2,"0");case"s":return String(r.$s);case"ss":return o.s(r.$s,2,"0");case"SSS":return o.s(r.$ms,3,"0");case"Z":return i}return null})(D)||i.replace(":","")}))},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(t,r,e){var a,i=this,l=o.p(r),m=p(t),v=(m.utcOffset()-this.utcOffset())*_,y=this-m,b=function(){return o.m(i,m)};switch(l){case h:a=b()/12;break;case f:a=b();break;case u:a=b()/3;break;case N:a=(y-v)/6048e5;break;case C:a=(y-v)/864e5;break;case k:a=y/q;break;case O:a=y/_;break;case S:a=y/x;break;default:a=y}return e?a:o.a(a)},s.daysInMonth=function(){return this.endOf(f).$D},s.$locale=function(){return L[this.$L]},s.locale=function(t,r){if(!t)return this.$L;var e=this.clone(),a=J(t,r,!0);return a&&(e.$L=a),e},s.clone=function(){return o.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},n})(),ut=Z.prototype;return p.prototype=ut,[["$ms",T],["$s",S],["$m",O],["$H",k],["$W",C],["$M",f],["$y",h],["$D",g]].forEach((function(n){ut[n[1]]=function(s){return this.$g(s,n[0],n[1])}})),p.extend=function(n,s){return n.$i||(n(s,Z,p),n.$i=!0),p},p.locale=J,p.isDayjs=st,p.unix=function(n){return p(1e3*n)},p.en=L[W],p.Ls=L,p.p={},p}))})(tt)),tt.exports}var Lt=At();const at=Yt(Lt),jt={class:"bar-chart-wrapper"},zt={__name:"BarChart",props:{data:{type:Object,required:!0}},setup(w){ct.register(bt,xt,wt,St,Ot,kt,qt);const I=w,x=Y(null);let _=null;return it(()=>{x.value&&(_=new ct(x.value,{type:"bar",data:I.data,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Enrollments Last 7 Days",color:"#2c3e50"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{color:"#2c3e50"},grid:{color:"#e0e0e0"}},x:{ticks:{color:"#2c3e50"},grid:{color:"#f5f5f5"}}},elements:{bar:{borderRadius:6,borderSkipped:!1}}}}))}),pt(()=>I.data,q=>{_&&(_.data=q,_.update())},{deep:!0}),(q,T)=>(V(),ft("div",jt,[d("canvas",{ref_key:"canvas",ref:x},null,512)]))}},Ht=Ct(zt,[["__scopeId","data-v-b7dbf3c9"]]),It={class:"q-pa-md row q-gutter-md"},Nt={class:"text-h6"},Qt={class:"text-h6"},Bt={class:"text-h6"},Et={class:"text-h6"},Pt={class:"row q-col-gutter-md"},Rt={class:"col-8"},Wt={class:"row items-center q-mb-sm"},Ut={class:"col-4"},Ft={class:"row items-center q-mb-sm"},te={__name:"DashboardPage",setup(w){const I=Y([]),x=Y([]),_=Y([]),q=Y([]),T=Y(0),S=Y(0),O=Y(0),k=Y(0);it(async()=>{try{const[f,u,h]=await Promise.all([E.get("/admin/trainees?page=1&limit=10&search="),E.get("/admin/get-all-training-program?page=1&limit=10&search="),E.get("/admin/enrollments")]),g=f.data.trainees,Q=u.data.programs;_.value=h.data.enrollments,T.value=g.length,S.value=Q.filter(M=>M.t_status==="Upcoming").length,O.value=Q.filter(M=>M.t_status==="Ongoing").length,k.value=_.value.filter(M=>M.status==="Pending").length,q.value=_.value.slice(-5).map(M=>({id:M._id,message:`${M.user?.full_name||"Unknown"} enrolled in ${M.training_program?.t_name||"Program"}`,time:at(M.createdAt).fromNow()}))}catch(f){console.error("Dashboard fetch error:",f)}}),it(async()=>{const[f,u,h]=await Promise.all([E.get("https://staging2.egovmz.in/admin/trainees?page=1&limit=10&search="),E.get("https://staging2.egovmz.in/admin/get-all-training-program?page=1&limit=10&search="),E.get("https://staging2.egovmz.in/admin/enrollments")]);I.value=f.data.trainees,x.value=u.data.programs,_.value=h.data.enrollments,T.value=I.value.length,S.value=x.value.filter(g=>g.t_status==="Upcoming").length,O.value=x.value.filter(g=>g.t_status==="Ongoing").length,k.value=_.value.filter(g=>g.status==="Pending").length});const N=yt(()=>{const f=Array.from({length:7},(h,g)=>at().subtract(6-g,"day").format("YYYY-MM-DD")),u=f.map(h=>_.value.filter(g=>at(g.createdAt).format("YYYY-MM-DD")===h).length);return{labels:f,datasets:[{label:"Enrollments",data:u,backgroundColor:"#42A5F5"}]}});return(f,u)=>(V(),rt(Mt,{class:"q-pa-md"},{default:$(()=>[u[8]||(u[8]=d("div",{class:"text-h5 q-mb-md"},"Welcome, Admin!",-1)),d("div",It,[c(P,{class:"col-3 bg-primary text-white"},{default:$(()=>[c(K,{class:"flex items-center"},{default:$(()=>[c(H,{name:"groups",size:"32px",class:"q-mr-md"}),d("div",null,[u[0]||(u[0]=d("div",{class:"text-subtitle2"},"Total Trainees",-1)),d("div",Nt,R(T.value),1)])]),_:1})]),_:1}),c(P,{class:"col-3 bg-positive text-white"},{default:$(()=>[c(K,{class:"flex items-center"},{default:$(()=>[c(H,{name:"event",size:"32px",class:"q-mr-md"}),d("div",null,[u[1]||(u[1]=d("div",{class:"text-subtitle2"},"Upcoming Trainings",-1)),d("div",Qt,R(S.value),1)])]),_:1})]),_:1}),c(P,{class:"col-3 bg-info text-white"},{default:$(()=>[c(K,{class:"flex items-center"},{default:$(()=>[c(H,{name:"play_circle",size:"32px",class:"q-mr-md"}),d("div",null,[u[2]||(u[2]=d("div",{class:"text-subtitle2"},"Ongoing Trainings",-1)),d("div",Bt,R(O.value),1)])]),_:1})]),_:1}),c(P,{class:"col-3 bg-warning text-white"},{default:$(()=>[c(K,{class:"flex items-center"},{default:$(()=>[c(H,{name:"hourglass_empty",size:"32px",class:"q-mr-md"}),d("div",null,[u[3]||(u[3]=d("div",{class:"text-subtitle2"},"Pending Enrollments",-1)),d("div",Et,R(k.value),1)])]),_:1})]),_:1})]),d("div",Pt,[d("div",Rt,[c(P,{class:"q-pa-md shadow-2 rounded-borders"},{default:$(()=>[d("div",Wt,[c(H,{name:"bar_chart",size:"28px",class:"text-primary q-mr-sm"}),u[4]||(u[4]=d("div",{class:"text-h6"},"Enrollments Last 7 Days",-1))]),c(Ht,{data:N.value},null,8,["data"]),u[5]||(u[5]=d("div",{class:"q-mt-md text-grey text-caption"}," Chart placeholder ",-1))]),_:1})]),d("div",Ut,[c(P,{class:"q-pa-md shadow-2 rounded-borders"},{default:$(()=>[d("div",Ft,[c(H,{name:"history",size:"24px",class:"text-primary q-mr-sm"}),u[6]||(u[6]=d("div",{class:"text-h6"},"Recent Activity",-1))]),c(Dt,{separator:""},{default:$(()=>[(V(!0),ft(vt,null,$t(q.value,h=>(V(),rt(lt,{key:h.id},{default:$(()=>[c(X,{avatar:""},{default:$(()=>[c(H,{name:"notifications",color:"secondary"})]),_:1}),c(X,null,{default:$(()=>[nt(R(h.message),1)]),_:2},1024),c(X,{side:"",class:"text-caption text-grey"},{default:$(()=>[nt(R(h.time),1)]),_:2},1024)]),_:2},1024))),128)),q.value.length===0?(V(),rt(lt,{key:0},{default:$(()=>[c(X,{class:"text-grey"},{default:$(()=>[...u[7]||(u[7]=[nt("No recent activity",-1)])]),_:1})]),_:1})):_t("",!0)]),_:1})]),_:1})])])]),_:1}))}};export{te as default};
