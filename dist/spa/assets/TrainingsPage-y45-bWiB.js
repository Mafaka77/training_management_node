import{a as ee,Q as k}from"./QTabs-gCNjH1lx.js";import{w as te,J as se,k as d,m as I,n as r,s as t,p as l,W as n,X as C,Y as T,Z as w,$ as c,ac as V,a0 as o,q as u,_ as f,a8 as M,Q as U,al as ae,ai as le,ad as O,a7 as oe,a1 as re,r as p,ag as q,f as z}from"./index-Bzn0LiPU.js";import{Q as ie}from"./QChip-COUtrNlO.js";import{Q as E}from"./QImg-B-Xiv_j_.js";import{Q as de}from"./QBadge-CCt-JOPv.js";import{Q as ne}from"./QFile-CjdTDf9_.js";import{Q as L}from"./QLinearProgress-DAd5lNjJ.js";import{Q as me}from"./QExpansionItem-DHqR8eY7.js";import{Q as ue}from"./QPagination-DTvbNWWr.js";import{Q as pe}from"./QSelect-ChM7-dt3.js";import{Q as ce}from"./QInnerLoading-U62VBq2U.js";import{Q as ge}from"./QPage-DWBr2NDD.js";import{C as W}from"./ClosePopup-C6H1DDOC.js";import{u as _e}from"./use-quasar-CLO-DOJZ.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QResizeObserver-DM40u9wL.js";import"./rtl-DFPa-2ov.js";import"./use-file-C-vdhq8C.js";import"./format-DyQxkAtJ.js";import"./QItemSection-COOhA9zR.js";import"./QItemLabel-BQHMT6Ru.js";import"./QMenu-2e4m313B.js";import"./position-engine-BCFNfW53.js";import"./selection-DFkNIa7B.js";const xe={class:"row q-col-gutter-md q-mt-md"},fe=["onClick"],ye={key:0,class:"absolute-full flex flex-center bg-grey-4"},be={class:"absolute-bottom bg-black/60 text-white q-pa-sm"},he={class:"text-h6 q-mb-xs"},we={class:"text-caption ellipsis"},qe={class:"row items-center q-mt-xs justify-between"},Qe={class:"row items-center justify-between q-mb-xs"},ke={class:"text-subtitle2 text-primary text-weight-medium"},Ce={class:"text-grey-8 text-caption"},Te={class:"text-grey-8 text-caption"},Ve={class:"text-grey-8 text-caption"},Ue={class:"text-grey-8 text-caption q-mb-sm"},De={class:"q-mt-sm text-body2 text-grey-9 ellipsis-3-lines"},Pe={key:0,class:"q-mt-sm"},Fe={key:1},ze=["href"],$e={key:0},Ne={key:1},Se={class:"q-mt-lg q-pa-md flex flex-center column"},Ae={class:"absolute-bottom bg-gradient-to-top from-black/60 text-white q-pa-md"},Be={class:"text-h5 text-weight-bold ellipsis"},Ie={key:1,class:"banner-fallback flex flex-center bg-grey-3",style:{height:"200px"}},Me={class:"text-body1 q-mb-md"},Oe={class:"row q-col-gutter-md"},Ee={class:"col-12 col-sm-6"},Le={class:"text-body1 text-weight-medium"},We={class:"col-12 col-sm-6"},je={class:"text-body1 text-weight-medium"},Re={class:"col-12 col-sm-6"},Ge={class:"text-body1 text-weight-medium"},Je={class:"col-12 col-sm-6"},Xe={class:"text-body1 text-weight-medium"},Ye={key:0},Ze=["href"],He={key:1,class:"text-grey text-caption"},Ke={__name:"TrainingsPage",setup(et){const g=_e(),D=p([]),P=p(!1),y=p("all"),Q=p(1),_=p(6),j=p({}),F=p(!1),m=p(null),b=p({}),h=p({}),R=async()=>{P.value=!0;try{const a=await q.get("/admin/trainer/training/program");D.value=a.data.data||[]}catch{g.notify({type:"negative",message:"Failed to load trainings"})}finally{P.value=!1}},G=async a=>{const e=b.value[a._id];if(!e||e.length===0){g.notify({type:"warning",message:"Please select files to upload"});return}for(const s of e){const i=new FormData;i.append("materials",s),h.value[a._id]=0;try{const x=await q.post(`/admin/trainer/course/${a._id}/materials`,i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:B=>{h.value[a._id]=B.loaded/B.total}});if(x.status===201||x.status===200)g.notify({type:"positive",message:`${s.name} uploaded successfully`});else throw new Error}catch(x){console.error("Upload error:",x.response?.data||x.message),g.notify({type:"negative",message:x.response?.data?.message||`Failed to upload ${s.name}`})}finally{h.value[a._id]=0}}b.value[a._id]=[]},J=async a=>{try{const e=await q.get(`/admin/trainer/training/${a}`);m.value=e.data?.course,F.value=!0}catch{g.notify({type:"negative",message:"Failed to load details"})}},v=a=>a?new Date(a).toLocaleString("en-IN"):"—",X=a=>a===-1?"Unlimited":a||"N/A",$=a=>a==="Upcoming"?"blue":a==="Ongoing"?"green":a==="Finished"?"grey":"primary",N=a=>a?a.startsWith("http://")||a.startsWith("https://")?a:a.startsWith("/")?`${q.defaults.baseURL}${a}`:`${q.defaults.baseURL}/uploads/${a}`:"",S=a=>a?`https://staging2.egovmz.in${a.replace(/^.*\/uploads/,"/uploads")}`:"#",Y=a=>a?.startsWith("image/")?"image":a==="application/pdf"?"picture_as_pdf":"insert_drive_file",Z=a=>a?.startsWith("image/")?"blue":a==="application/pdf"?"red":"grey",A=z(()=>y.value==="all"?D.value:D.value.filter(a=>a.t_program?.t_status===y.value)),H=z(()=>{const a=(Q.value-1)*_.value;return A.value.slice(a,a+_.value)}),K=z(()=>Math.max(1,Math.ceil(A.value.length/_.value)));return te([y,_],()=>Q.value=1),se(R),(a,e)=>(d(),I(ge,{class:"q-pa-md bg-grey-1"},{default:r(()=>[e[28]||(e[28]=t("div",{class:"text-h5 text-weight-bold q-mb-lg"},"Trainer Programs",-1)),l(ee,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),dense:"",class:"text-primary q-mb-md",align:"left","active-color":"primary","indicator-color":"primary"},{default:r(()=>[l(k,{name:"all",label:"All"}),l(k,{name:"Upcoming",label:"Upcoming"}),l(k,{name:"Ongoing",label:"Ongoing"}),l(k,{name:"Finished",label:"Finished"})]),_:1},8,["modelValue"]),t("div",xe,[(d(!0),n(C,null,T(H.value,s=>(d(),n("div",{key:s._id,class:"col-12 col-md-6 col-lg-4"},[l(w,{flat:"",bordered:"",class:"hover-scale shadow-sm cursor-pointer"},{default:r(()=>[t("div",{onClick:i=>J(s._id),class:"cursor-pointer"},[l(E,{src:N(s.t_program?.t_banner),ratio:16/9,alt:"Training Banner"},{default:r(()=>[s.t_program?.t_banner?V("",!0):(d(),n("div",ye,[l(c,{name:"image",size:"48px",color:"grey-6"}),e[5]||(e[5]=t("div",{class:"text-grey-6 q-mt-md"},"No Banner Available",-1))])),t("div",be,[t("div",he,o(s.t_program?.t_name||"Untitled Program"),1),t("div",we,o(s.t_program?.t_description),1),t("div",qe,[l(ie,{dense:"",color:$(s.t_program?.t_status),"text-color":"white"},{default:r(()=>[u(o(s.t_program?.t_status),1)]),_:2},1032,["color"])])])]),_:2},1032,["src"]),l(f,{class:"q-pt-sm"},{default:r(()=>[t("div",Qe,[t("div",ke,o(s.t_program?.t_category?.name||"General"),1),l(de,{color:$(s.t_program?.t_status),label:s.t_program?.t_status,class:"text-uppercase"},null,8,["color","label"])]),t("div",Ce,[l(c,{name:"event",size:"16px",class:"q-mr-xs"}),u(" "+o(v(s.t_program?.t_start_date))+" → "+o(v(s.t_program?.t_end_date)),1)]),t("div",Te,[l(c,{name:"hourglass_bottom",size:"16px",class:"q-mr-xs"}),u(" Duration: "+o(s.t_program?.t_duration)+" days ",1)]),t("div",Ve,[l(c,{name:"badge",size:"16px",class:"q-mr-xs"}),e[6]||(e[6]=u(" Eligibility: ",-1)),t("strong",null,o(s.t_program?.t_eligibility||"All Employees"),1)]),t("div",Ue,[l(c,{name:"account_balance",size:"16px",class:"q-mr-xs"}),e[7]||(e[7]=u(" Organizer: ",-1)),t("strong",null,o(s.t_program?.t_organizer||"ATI"),1)]),t("div",De,[e[8]||(e[8]=t("strong",null,"Topic:",-1)),u(" "+o(s.tc_topic),1),e[9]||(e[9]=t("br",null,null,-1)),e[10]||(e[10]=t("strong",null,"Description:",-1)),u(" "+o(s.tc_description),1)])]),_:2},1024)],8,fe),l(M),l(f,null,{default:r(()=>[e[11]||(e[11]=t("div",{class:"text-subtitle2 q-mb-sm"},"Training Materials",-1)),l(ne,{modelValue:b.value[s._id],"onUpdate:modelValue":i=>b.value[s._id]=i,multiple:"",outlined:"","use-chips":"",label:"Select materials...",accept:".pdf,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg",class:"q-mt-md"},null,8,["modelValue","onUpdate:modelValue"]),l(U,{color:"primary",label:"Upload",icon:"upload",class:"q-mt-sm",onClick:i=>G(s),disable:!b.value[s._id]?.length},null,8,["onClick","disable"]),h.value[s._id]?(d(),n("div",Pe,[l(L,{value:h.value[s._id],color:"green",size:"10px",rounded:"",stripe:"",animated:""},null,8,["value"])])):V("",!0),s.materials?.length?(d(),n("div",Fe,[(d(!0),n(C,null,T(s.materials,i=>(d(),n("div",{key:i._id,class:"q-mb-xs flex items-center"},[l(c,{name:Y(i.mime_type),color:Z(i.mime_type),size:"40px",class:"q-mr-sm"},null,8,["name","color"]),t("a",{href:S(i.file_url),target:"_blank",class:"text-primary text-weight-medium ellipsis"},o(i.file_name),9,ze)]))),128))])):V("",!0),(d(!0),n(C,null,T(j.value[s._id]||[],i=>(d(),n("div",{key:i.name,class:"q-mt-xs"},[u(o(i.name)+" ",1),l(L,{value:i.progress,color:"primary","track-color":"grey-3",class:"q-mt-xs"},null,8,["value"]),i.status==="done"?(d(),n("span",$e,"✅")):i.status==="error"?(d(),n("span",Ne,"❌")):V("",!0)]))),128))]),_:2},1024),l(M),l(me,{label:"More Info",icon:"info",dense:""},{default:r(()=>[t("div",null,[e[12]||(e[12]=t("b",null,"Session:",-1)),u(" "+o(s.tc_session),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Created:",-1)),u(" "+o(v(s.createdAt)),1)]),t("div",null,[e[14]||(e[14]=t("b",null,"Capacity:",-1)),u(" "+o(X(s.t_program?.t_capacity)),1)])]),_:2},1024)]),_:2},1024)]))),128))]),t("div",Se,[l(ue,{modelValue:Q.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Q.value=s),max:K.value,"max-pages":"7","boundary-numbers":"","direction-links":"",color:"primary",class:"q-mb-md"},null,8,["modelValue","max"]),l(pe,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),options:[6,12,24],label:"Rows per page",outlined:"",dense:"",style:{width:"150px"}},null,8,["modelValue"])]),l(ce,{showing:P.value},{default:r(()=>[l(ae,{color:"primary",size:"50px"})]),_:1},8,["showing"]),l(le,{modelValue:F.value,"onUpdate:modelValue":e[4]||(e[4]=s=>F.value=s),style:{"min-width":"750px"}},{default:r(()=>[l(w,{class:"q-relative enrollment-dialog-card"},{default:r(()=>[m.value?.t_program?.t_banner?(d(),I(E,{key:0,src:N(m.value.t_program.t_banner),class:"banner-image",alt:"Training Banner"},{default:r(()=>[t("div",Ae,[t("div",Be,o(m.value.t_program.t_name),1),e[15]||(e[15]=t("div",{class:"text-subtitle2 ellipsis"},"Training Details",-1))])]),_:1},8,["src"])):(d(),n("div",Ie,[l(c,{name:"image",size:"64px",color:"grey-5"}),e[16]||(e[16]=t("div",{class:"text-h6 text-grey-6 q-ml-md"},"No Banner Available",-1))])),O(l(U,{flat:"",round:"",icon:"close",class:"absolute-top-right text-white"},null,512),[[W]]),l(f,{class:"scroll q-pa-md",style:{"max-height":"75vh","overflow-y":"auto"}},{default:r(()=>[l(w,{flat:"",bordered:"",class:"q-mb-md shadow-1"},{default:r(()=>[l(f,null,{default:r(()=>[e[21]||(e[21]=t("div",{class:"text-h6 text-primary text-weight-bold q-mb-sm"},"Program Overview",-1)),t("div",Me,o(m.value.t_program?.t_description||"No description available."),1),t("div",Oe,[t("div",Ee,[e[17]||(e[17]=t("div",{class:"text-caption text-grey"},"Category",-1)),t("div",Le,o(m.value.t_program?.t_category?.name||"General"),1)]),t("div",We,[e[18]||(e[18]=t("div",{class:"text-caption text-grey"},"Organizer",-1)),t("div",je,o(m.value.t_program?.t_organizer||"ATI"),1)]),t("div",Re,[e[19]||(e[19]=t("div",{class:"text-caption text-grey"},"Start Date",-1)),t("div",Ge,o(v(m.value.t_program?.t_start_date)),1)]),t("div",Je,[e[20]||(e[20]=t("div",{class:"text-caption text-grey"},"End Date",-1)),t("div",Xe,o(v(m.value.t_program?.t_end_date)),1)])])]),_:1})]),_:1}),l(w,{flat:"",bordered:"",class:"q-mb-md shadow-1"},{default:r(()=>[l(f,null,{default:r(()=>[e[26]||(e[26]=t("div",{class:"text-h6 text-primary text-weight-bold q-mb-sm"},"Trainer Session Details",-1)),t("div",null,[e[22]||(e[22]=t("b",null,"Topic:",-1)),u(" "+o(m.value.tc_topic||"N/A"),1)]),t("div",null,[e[23]||(e[23]=t("b",null,"Description:",-1)),u(" "+o(m.value.tc_description||"No details available"),1)]),t("div",null,[e[24]||(e[24]=t("b",null,"Session:",-1)),u(" "+o(m.value.tc_session||"—"),1)]),t("div",null,[e[25]||(e[25]=t("b",null,"Created On:",-1)),u(" "+o(v(m.value.createdAt)),1)])]),_:1})]),_:1}),l(w,{flat:"",bordered:"",class:"shadow-1"},{default:r(()=>[l(f,null,{default:r(()=>[e[27]||(e[27]=t("div",{class:"text-h6 text-primary text-weight-bold q-mb-sm"},"Training Materials",-1)),m.value.materials?.length?(d(),n("div",Ye,[(d(!0),n(C,null,T(m.value.materials,s=>(d(),n("div",{key:s._id,class:"q-mb-sm"},[t("a",{href:S(s.file_url),target:"_blank",class:"text-primary text-weight-medium"},o(s.file_name),9,Ze)]))),128))])):(d(),n("div",He,"No materials uploaded yet."))]),_:1})]),_:1})]),_:1}),l(oe,{align:"right",class:"q-pa-md"},{default:r(()=>[O(l(U,{flat:"",label:"Close",color:"grey"},null,512),[[W]]),l(U,{color:"primary",label:"Upload Materials",icon:"upload",onClick:e[3]||(e[3]=()=>re(g).notify({type:"info",message:"Upload via training card section."}))})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},kt=ve(Ke,[["__scopeId","data-v-b59e1dd2"]]);export{kt as default};
