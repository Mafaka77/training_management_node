import{J as k,k as n,m as _,n as s,s as a,p as o,Z as m,_ as c,a0 as l,a8 as S,W as D,X as $,Y as B,q as g,ac as y,ag as h,r as x}from"./index-Bzn0LiPU.js";import{Q as w}from"./QRating-B5vDZbVV.js";import{Q as R}from"./QBadge-CCt-JOPv.js";import{Q as C}from"./QTooltip-bg_yg9Hm.js";import{Q as L}from"./QChip-COUtrNlO.js";import{Q as M}from"./QLinearProgress-DAd5lNjJ.js";import{Q as N}from"./QPage-DWBr2NDD.js";import"./format-DyQxkAtJ.js";import"./position-engine-BCFNfW53.js";import"./selection-DFkNIa7B.js";const E={class:"q-gutter-md row"},F={class:"text-h4"},z={class:"text-h4"},P={class:"text-h4"},A={class:"text-h6"},I={class:"text-subtitle2 text-grey"},J={class:"q-mt-sm row items-center q-gutter-xs"},W={class:"q-mt-sm"},X={class:"text-caption q-ml-sm"},Y={class:"text-caption text-white"},lt={__name:"TrainerDashboard",setup(Z){const d=x({totalTrainings:0,upcomingTrainings:0,materialsUploaded:0,averageRating:0}),u=x([]),p=x({}),Q=async()=>{try{const e=(await h.get("/admin/trainer/training/program")).data.data||[];e.forEach(r=>r.userRating=r.t_program.averageRating||0),u.value=e.filter(r=>r.t_program.t_status==="Upcoming"),d.value.totalTrainings=e.length,d.value.upcomingTrainings=u.value.length,d.value.averageRating=e.reduce((r,v)=>r+(v.t_program.averageRating||0),0)/(e.length||1);const t=await h.get("/trainer/materials");d.value.materialsUploaded=t.data.data?.length||0,u.value.forEach(r=>{const v=new Date(r.tc_start_time).getTime(),b=new Date().getTime(),f=v-b;if(f>0){const q=Math.floor(f/864e5),V=Math.floor(f%(1e3*60*60*24)/(1e3*60*60));p.value[r._id]=`${q}d ${V}h`}else p.value[r._id]="Started"})}catch(i){console.error(i)}},T=i=>new Date(i).toLocaleString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=async(i,e)=>{try{await h.post(`/trainer/training/${i}/rate`,{rating:e}),console.log(`Rating submitted for training ${i}: ${e}`)}catch(t){console.error(t)}};return k(Q),(i,e)=>(n(),_(N,{class:"q-pa-md"},{default:s(()=>[a("div",E,[o(m,{class:"col-12 col-md-3 text-center bg-primary text-white"},{default:s(()=>[o(c,null,{default:s(()=>[e[1]||(e[1]=a("div",{class:"text-h6"},"Total Trainings",-1)),a("div",F,l(d.value.totalTrainings),1)]),_:1})]),_:1}),o(m,{class:"col-12 col-md-3 text-center bg-teal text-white"},{default:s(()=>[o(c,null,{default:s(()=>[e[2]||(e[2]=a("div",{class:"text-h6"},"Upcoming Trainings",-1)),a("div",z,l(d.value.upcomingTrainings),1)]),_:1})]),_:1}),o(m,{class:"col-12 col-md-3 text-center bg-orange text-white"},{default:s(()=>[o(c,null,{default:s(()=>[e[3]||(e[3]=a("div",{class:"text-h6"},"Materials Uploaded",-1)),a("div",P,l(d.value.materialsUploaded),1)]),_:1})]),_:1}),o(m,{class:"col-12 col-md-3 text-center bg-purple text-white"},{default:s(()=>[o(c,null,{default:s(()=>[e[4]||(e[4]=a("div",{class:"text-h6"},"Avg Rating",-1)),o(w,{modelValue:d.value.averageRating,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value.averageRating=t),color:"yellow",max:"5",size:"25px",readonly:""},null,8,["modelValue"]),a("div",null,l(d.value.averageRating.toFixed(1))+"/5",1)]),_:1})]),_:1})]),o(S,{class:"q-my-md"}),a("div",null,[e[5]||(e[5]=a("div",{class:"text-h6 q-mb-md"},"Upcoming Trainings",-1)),(n(!0),D($,null,B(u.value,t=>(n(),_(m,{key:t._id,class:"q-mb-md hover bordered"},{default:s(()=>[o(c,null,{default:s(()=>[a("div",A,l(t.t_program.t_name),1),a("div",I,l(t.t_program.t_description),1),a("div",J,[o(R,{color:"primary"},{default:s(()=>[g(l(t.t_program.t_status),1)]),_:2},1024),o(R,{color:"secondary"},{default:s(()=>[g(l(t.tc_start_time)+" - "+l(t.tc_end_time),1)]),_:2},1024),o(C,{anchor:"bottom middle",self:"top middle"},{default:s(()=>[g(" Starts at: "+l(T(t.tc_start_time)),1)]),_:2},1024),p.value[t._id]?(n(),_(L,{key:0,color:"red"},{default:s(()=>[g(l(p.value[t._id]),1)]),_:2},1024)):y("",!0)]),a("div",W,[o(w,{modelValue:t.userRating,"onUpdate:modelValue":r=>t.userRating=r,color:"yellow",max:"5",size:"20px",onInput:r=>U(t._id,t.userRating)},null,8,["modelValue","onUpdate:modelValue","onInput"]),a("span",X,l(t.userRating)+"/5",1)]),t.materialsUploaded&&t.t_program.t_capacity?(n(),_(M,{key:0,value:t.materialsUploaded/t.t_program.t_capacity,color:"teal",class:"q-mt-sm"},{default:s(()=>[a("div",Y,l(t.materialsUploaded||0)+"/"+l(t.t_program.t_capacity)+" materials ",1)]),_:2},1032,["value"])):y("",!0)]),_:2},1024)]),_:2},1024))),128))])]),_:1}))}};export{lt as default};
