import{g as E,f as F,aT as I,ae as _,aa as A,d as O,r as U}from"./index-CyB-vvD0.js";function c(a,u,g,p){const i=[];return a.forEach(f=>{p(f)===!0?i.push(f):u.push({failedPropValidation:g,file:f})}),i}function m(a){a?.dataTransfer&&(a.dataTransfer.dropEffect="copy"),_(a)}const M={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},R=["rejected"];function X({editable:a,dnd:u,getFileInput:g,addFilesToQueue:p}){const{props:i,emit:f,proxy:D}=E(),d=U(null),z=F(()=>i.accept!==void 0?i.accept.split(",").map(e=>(e=e.trim(),e==="*"?"*/":(e.endsWith("/*")&&(e=e.slice(0,e.length-1)),e.toUpperCase()))):null),S=F(()=>parseInt(i.maxFiles,10)),x=F(()=>parseInt(i.maxTotalSize,10));function b(e){if(a.value)if(e!==Object(e)&&(e={target:null}),e.target?.matches('input[type="file"]')===!0)e.clientX===0&&e.clientY===0&&I(e);else{const l=g();l!==e.target&&l?.click(e)}}function y(e){a.value&&e&&p(null,e)}function N(e,l,v,h){let t=Array.from(l||e.target.files);const s=[],o=()=>{s.length!==0&&f("rejected",s)};if(i.accept!==void 0&&z.value.indexOf("*/")===-1&&(t=c(t,s,"accept",n=>z.value.some(r=>n.type.toUpperCase().startsWith(r)||n.name.toUpperCase().endsWith(r))),t.length===0))return o();if(i.maxFileSize!==void 0){const n=parseInt(i.maxFileSize,10);if(t=c(t,s,"max-file-size",r=>r.size<=n),t.length===0)return o()}if(i.multiple!==!0&&t.length!==0&&(t=[t[0]]),t.forEach(n=>{n.__key=n.webkitRelativePath+n.lastModified+n.name+n.size}),h===!0){const n=v.map(r=>r.__key);t=c(t,s,"duplicate",r=>n.includes(r.__key)===!1)}if(t.length===0)return o();if(i.maxTotalSize!==void 0){let n=h===!0?v.reduce((r,C)=>r+C.size,0):0;if(t=c(t,s,"max-total-size",r=>(n+=r.size,n<=x.value)),t.length===0)return o()}if(typeof i.filter=="function"){const n=i.filter(t);t=c(t,s,"filter",r=>n.includes(r))}if(i.maxFiles!==void 0){let n=h===!0?v.length:0;if(t=c(t,s,"max-files",()=>(n++,n<=S.value)),t.length===0)return o()}if(o(),t.length!==0)return t}function k(e){m(e),u.value!==!0&&(u.value=!0)}function T(e){_(e),(e.relatedTarget!==null||A.is.safari!==!0?e.relatedTarget!==d.value:document.elementsFromPoint(e.clientX,e.clientY).includes(d.value)===!1)===!0&&(u.value=!1)}function j(e){m(e);const l=e.dataTransfer.files;l.length!==0&&p(null,l),u.value=!1}function P(e){if(u.value===!0)return O("div",{ref:d,class:`q-${e}__dnd absolute-full`,onDragenter:m,onDragover:m,onDragleave:T,onDrop:j})}return Object.assign(D,{pickFiles:b,addFiles:y}),{pickFiles:b,addFiles:y,onDragover:k,onDragleave:T,processFiles:N,getDndNode:P,maxFilesNumber:S,maxTotalSizeNumber:x}}export{M as a,X as b,R as u};
