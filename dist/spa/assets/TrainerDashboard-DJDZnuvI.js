import{a as vt,al as ft,am as ht,an as V,ao as pt,ap as _t,ah as yt,aq as Tt,ar as xt,w as N,o as j,a9 as F,ad as I,as as wt,d as W,ai as bt,g as St,r as R,f as k,at as Pt,u as Rt,ae as kt,y as qt,k as b,m as q,n as l,s,p as n,L as S,M as P,O as u,X as Ct,I as Ot,J as Qt,K as Et,q as C,$ as z,a3 as D}from"./index-DIC-NUZQ.js";import{Q as J}from"./QRating-CX20yEJB.js";import{Q as K}from"./QBadge-DltXcwia.js";import{v as Ut,a as X,u as Vt,b as Dt,c as Mt,d as Ht,r as G,s as Lt,p as Y}from"./position-engine-CWV-Om3e.js";import{c as Z}from"./selection-DspvkYyK.js";import{Q as $t}from"./QChip-CFPVEymU.js";import{Q as At}from"./QLinearProgress-TVOrjDvo.js";import{Q as Bt}from"./QPage-B0X2t0lv.js";import"./format-DyQxkAtJ.js";const Nt=vt({name:"QTooltip",inheritAttrs:!1,props:{...Vt,...pt,...V,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...V.transitionShow,default:"jump-down"},transitionHide:{...V.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:X},self:{type:String,default:"top middle",validator:X},offset:{type:Array,default:()=>[14,14],validator:Ut},scrollTarget:ht,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...ft],setup(a,{slots:d,emit:g,attrs:m}){let v,f;const _=St(),{proxy:{$q:o}}=_,e=R(null),t=R(!1),r=k(()=>Y(a.anchor,o.lang.rtl)),y=k(()=>Y(a.self,o.lang.rtl)),O=k(()=>a.persistent!==!0),{registerTick:T,removeTick:Q}=_t(),{registerTimeout:p}=yt(),{transitionProps:tt,transitionStyle:et}=Pt(a),{localScrollTarget:M,changeScrollEvent:at,unconfigureScrollTarget:ot}=Dt(a,A),{anchorEl:c,canShow:st,anchorEvents:x}=Mt({showing:t,configureAnchorEl:ct}),{show:lt,hide:E}=Tt({showing:t,canShow:st,handleShow:nt,handleHide:it,hideOnRouteChange:O,processOnMount:!0});Object.assign(x,{delayShow:ut,delayHide:dt});const{showPortal:H,hidePortal:L,renderPortal:rt}=xt(_,e,gt,"tooltip");if(o.platform.is.mobile===!0){const i={anchorEl:c,innerRef:e,onClickOutside(h){return E(h),h.target.classList.contains("q-dialog__backdrop")&&kt(h),!0}},U=k(()=>a.modelValue===null&&a.persistent!==!0&&t.value===!0);N(U,h=>{(h===!0?Ht:G)(i)}),j(()=>{G(i)})}function nt(i){H(),T(()=>{f=new MutationObserver(()=>w()),f.observe(e.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),w(),A()}),v===void 0&&(v=N(()=>o.screen.width+"|"+o.screen.height+"|"+a.self+"|"+a.anchor+"|"+o.lang.rtl,w)),p(()=>{H(!0),g("show",i)},a.transitionDuration)}function it(i){Q(),L(),$(),p(()=>{L(!0),g("hide",i)},a.transitionDuration)}function $(){f!==void 0&&(f.disconnect(),f=void 0),v!==void 0&&(v(),v=void 0),ot(),F(x,"tooltipTemp")}function w(){Lt({targetEl:e.value,offset:a.offset,anchorEl:c.value,anchorOrigin:r.value,selfOrigin:y.value,maxHeight:a.maxHeight,maxWidth:a.maxWidth})}function ut(i){if(o.platform.is.mobile===!0){Z(),document.body.classList.add("non-selectable");const U=c.value,h=["touchmove","touchcancel","touchend","click"].map(B=>[U,B,"delayHide","passiveCapture"]);I(x,"tooltipTemp",h)}p(()=>{lt(i)},a.delay)}function dt(i){o.platform.is.mobile===!0&&(F(x,"tooltipTemp"),Z(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),p(()=>{E(i)},a.hideDelay)}function ct(){if(a.noParentEvent===!0||c.value===null)return;const i=o.platform.is.mobile===!0?[[c.value,"touchstart","delayShow","passive"]]:[[c.value,"mouseenter","delayShow","passive"],[c.value,"mouseleave","delayHide","passive"]];I(x,"anchor",i)}function A(){if(c.value!==null||a.scrollTarget!==void 0){M.value=wt(c.value,a.scrollTarget);const i=a.noParentEvent===!0?w:E;at(M.value,i)}}function mt(){return t.value===!0?W("div",{...m,ref:e,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",m.class],style:[m.style,et.value],role:"tooltip"},Rt(d.default)):null}function gt(){return W(bt,tt.value,mt)}return j($),Object.assign(_.proxy,{updatePosition:w}),rt}}),jt={class:"q-gutter-md row"},Ft={class:"text-h4"},It={class:"text-h4"},Wt={class:"text-h4"},zt={class:"text-h6"},Jt={class:"text-subtitle2 text-grey"},Kt={class:"q-mt-sm row items-center q-gutter-xs"},Xt={class:"q-mt-sm"},Gt={class:"text-caption q-ml-sm"},Yt={class:"text-caption text-white"},ie={__name:"TrainerDashboard",setup(a){const d=R({totalTrainings:0,upcomingTrainings:0,materialsUploaded:0,averageRating:0}),g=R([]),m=R({}),v=async()=>{try{const e=(await D.get("/admin/trainer/training/program")).data.data||[];e.forEach(r=>r.userRating=r.t_program.averageRating||0),g.value=e.filter(r=>r.t_program.t_status==="Upcoming"),d.value.totalTrainings=e.length,d.value.upcomingTrainings=g.value.length,d.value.averageRating=e.reduce((r,y)=>r+(y.t_program.averageRating||0),0)/(e.length||1);const t=await D.get("/trainer/materials");d.value.materialsUploaded=t.data.data?.length||0,g.value.forEach(r=>{const y=new Date(r.tc_start_time).getTime(),O=new Date().getTime(),T=y-O;if(T>0){const Q=Math.floor(T/864e5),p=Math.floor(T%(1e3*60*60*24)/(1e3*60*60));m.value[r._id]=`${Q}d ${p}h`}else m.value[r._id]="Started"})}catch(o){console.error(o)}},f=o=>new Date(o).toLocaleString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=async(o,e)=>{try{await D.post(`/trainer/training/${o}/rate`,{rating:e}),console.log(`Rating submitted for training ${o}: ${e}`)}catch(t){console.error(t)}};return qt(v),(o,e)=>(b(),q(Bt,{class:"q-pa-md"},{default:l(()=>[s("div",jt,[n(S,{class:"col-12 col-md-3 text-center bg-primary text-white"},{default:l(()=>[n(P,null,{default:l(()=>[e[1]||(e[1]=s("div",{class:"text-h6"},"Total Trainings",-1)),s("div",Ft,u(d.value.totalTrainings),1)]),_:1})]),_:1}),n(S,{class:"col-12 col-md-3 text-center bg-teal text-white"},{default:l(()=>[n(P,null,{default:l(()=>[e[2]||(e[2]=s("div",{class:"text-h6"},"Upcoming Trainings",-1)),s("div",It,u(d.value.upcomingTrainings),1)]),_:1})]),_:1}),n(S,{class:"col-12 col-md-3 text-center bg-orange text-white"},{default:l(()=>[n(P,null,{default:l(()=>[e[3]||(e[3]=s("div",{class:"text-h6"},"Materials Uploaded",-1)),s("div",Wt,u(d.value.materialsUploaded),1)]),_:1})]),_:1}),n(S,{class:"col-12 col-md-3 text-center bg-purple text-white"},{default:l(()=>[n(P,null,{default:l(()=>[e[4]||(e[4]=s("div",{class:"text-h6"},"Avg Rating",-1)),n(J,{modelValue:d.value.averageRating,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value.averageRating=t),color:"yellow",max:"5",size:"25px",readonly:""},null,8,["modelValue"]),s("div",null,u(d.value.averageRating.toFixed(1))+"/5",1)]),_:1})]),_:1})]),n(Ct,{class:"q-my-md"}),s("div",null,[e[5]||(e[5]=s("div",{class:"text-h6 q-mb-md"},"Upcoming Trainings",-1)),(b(!0),Ot(Qt,null,Et(g.value,t=>(b(),q(S,{key:t._id,class:"q-mb-md hover bordered"},{default:l(()=>[n(P,null,{default:l(()=>[s("div",zt,u(t.t_program.t_name),1),s("div",Jt,u(t.t_program.t_description),1),s("div",Kt,[n(K,{color:"primary"},{default:l(()=>[C(u(t.t_program.t_status),1)]),_:2},1024),n(K,{color:"secondary"},{default:l(()=>[C(u(t.tc_start_time)+" - "+u(t.tc_end_time),1)]),_:2},1024),n(Nt,{anchor:"bottom middle",self:"top middle"},{default:l(()=>[C(" Starts at: "+u(f(t.tc_start_time)),1)]),_:2},1024),m.value[t._id]?(b(),q($t,{key:0,color:"red"},{default:l(()=>[C(u(m.value[t._id]),1)]),_:2},1024)):z("",!0)]),s("div",Xt,[n(J,{modelValue:t.userRating,"onUpdate:modelValue":r=>t.userRating=r,color:"yellow",max:"5",size:"20px",onInput:r=>_(t._id,t.userRating)},null,8,["modelValue","onUpdate:modelValue","onInput"]),s("span",Gt,u(t.userRating)+"/5",1)]),t.materialsUploaded&&t.t_program.t_capacity?(b(),q(At,{key:0,value:t.materialsUploaded/t.t_program.t_capacity,color:"teal",class:"q-mt-sm"},{default:l(()=>[s("div",Yt,u(t.materialsUploaded||0)+"/"+u(t.t_program.t_capacity)+" materials ",1)]),_:2},1032,["value"])):z("",!0)]),_:2},1024)]),_:2},1024))),128))])]),_:1}))}};export{ie as default};
